/*! For license information please see quad-tap.js.LICENSE.txt */
var e;e=()=>(()=>{var e={930:e=>{var t={width:"80%",maxWidth:"400px",padding:"8px 12px",borderRadius:"24px",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"space-around",alignItems:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",transition:"opacity 0.3s ease"},n={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},o={position:"static",top:"",left:"",transform:"",margin:"20px auto"},i={background:"none",border:"none",color:"white",fontSize:"18px",padding:"8px 12px",cursor:"pointer",borderRadius:"50%",width:"40px",height:"40px",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease"},a={backgroundColor:"rgba(255, 255, 255, 0.2)"},r={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"5px 10px",borderRadius:"4px",fontSize:"14px",zIndex:"2000",pointerEvents:"none",opacity:"0",transition:"opacity 0.3s ease"};function s(e,t){Object.assign(e.style,t)}function l(e,i){s(e,t),s(e,i?o:n)}function d(e,t,n){var o=document.createElement("button");return s(o,i),o.textContent=e,o.setAttribute("aria-label",t),o.addEventListener("mouseenter",(function(){s(o,a)})),o.addEventListener("mouseleave",(function(){o.style.backgroundColor=""})),o.addEventListener("click",n),o}function c(e){if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(e).catch((function(e){console.error("Failed to copy text: ",e)}));else{var t=document.createElement("textarea");t.value=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.error("Failed to copy text: ",e)}document.body.removeChild(t)}}function u(e,t){var n=document.createElement("div");s(n,r),n.textContent=t;var o=e.getBoundingClientRect();n.style.top="".concat(o.top-30,"px"),n.style.left="".concat(o.left+o.width/2,"px"),n.style.transform="translateX(-50%)",document.body.appendChild(n),setTimeout((function(){n.style.opacity="1"}),10),setTimeout((function(){n.style.opacity="0",setTimeout((function(){document.body.removeChild(n)}),300)}),1500)}e.exports={createControlStrip:function(e){var t=e.overlay,n=e.onPlay,o=e.onPause,i=e.onRewind,a=e.onForward,r=e.onShare,s=e.onCopyUrl,p=e.rewindTime,h=void 0===p?30:p,m=e.forwardTime,f=void 0===m?30:m,g=e.debug,v=void 0!==g&&g,y=e.showAllButtons,b=void 0!==y&&y,x=e.isLightbox,C=void 0!==x&&x,w=document.createElement("div");if(l(w,C),!C){var k=parseInt(getComputedStyle(t).zIndex)||1e3;w.style.zIndex=(k+10).toString()}var T=d("⟲"+h,"Rewind "+h+" seconds",i),j=d("▶","Play/Pause",(function(e){var t="▶"===j.textContent;j.textContent=t?"❚❚":"▶",t?n(e):o(e)})),S=d("⟳"+f,"Forward "+f+" seconds",a),E=d("⤴","Share",(function(e){if(e.stopPropagation(),r)r(e);else{var t=window.location.href;navigator.share?navigator.share({title:"Check out this video moment",url:t}).catch((function(e){console.error("Error sharing:",e)})):(c(t),u(E,"Link copied!"))}})),B=d("⧉","Copy URL",(function(e){e.stopPropagation(),s?s(e):(c(window.location.href),u(B,"Link copied!"))}));if(w.appendChild(T),w.appendChild(j),w.appendChild(S),(b||C)&&(w.appendChild(E),w.appendChild(B)),w.addEventListener("click",(function(e){e.stopPropagation(),v&&console.log("[QuadTap] Control strip clicked, propagation stopped")})),t.appendChild(w),!C){var P,N=function(){w.style.opacity="0.5"};w.addEventListener("mouseenter",(function(){clearTimeout(P),w.style.opacity="1"})),w.addEventListener("mouseleave",(function(){clearTimeout(P),P=setTimeout(N,2e3)})),w.style.opacity="1",P=setTimeout(N,2e3)}return v&&(console.log("[QuadTap] Control strip created with positioning:",{isLightbox:C,className:w.className,zIndex:w.style.zIndex}),C||new ResizeObserver((function(){var e=w.getBoundingClientRect(),n=t.getBoundingClientRect(),o=(e.top-n.top+e.height/2)/n.height*100,i=(e.left-n.left+e.width/2)/n.width*100;console.log("[QuadTap] Control strip position after resize:",{topPercent:o.toFixed(2)+"%",leftPercent:i.toFixed(2)+"%",width:e.width,height:e.height})})).observe(t)),w},updatePlayPauseButton:function(e,t){var n=e.querySelector("button:nth-child(2)");n&&(n.textContent=t?"❚❚":"▶")},showControlStrip:function(e){e.style.display="flex",e.style.opacity="1",e.classList.contains("qt-control-strip--overlay")&&setTimeout((function(){e.style.opacity="0.5"}),2e3)},hideControlStrip:function(e){e.style.opacity="0",setTimeout((function(){e.style.display="none"}),300)},copyToClipboard:c,showTooltip:u,applyControlStripLayout:l}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement(e);if(t.className&&(n.className=t.className),t.id&&(n.id=t.id),t.text&&(n.textContent=t.text),t.html&&(n.innerHTML=t.html),t.attributes)for(var o in t.attributes)n.setAttribute(o,t.attributes[o]);if(t.styles)for(var i in t.styles)n.style[i]=t.styles[i];if(t.events)for(var a in t.events)n.addEventListener(a,t.events[a]);return t.children&&t.children.forEach((function(e){n.appendChild(e)})),n}function a(e,t,n){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){var o=e.parentElement;if(o){var i=o.getBoundingClientRect();t=i.width*t,n=i.height*n}}e.style.left=t+"px",e.style.top=n+"px",e.style.transform="translate(-50%, -50%)"}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(o,{default:()=>C});var s="quadTap_";function l(e,t){try{var n=s+e;return"object"===r(t)?localStorage.setItem(n,JSON.stringify(t)):localStorage.setItem(n,t),!0}catch(e){return console.error("[QuadTap] Error saving to localStorage:",e),!1}}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var n=s+e,o=localStorage.getItem(n);if(null===o)return t;try{return JSON.parse(o)}catch(e){return o}}catch(e){return console.error("[QuadTap] Error retrieving from localStorage:",e),t}}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(){u=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n,o){return Object.defineProperty(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o})}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(t,n,o,i){var a=n&&n.prototype instanceof m?n:m,r=Object.create(a.prototype);return l(r,"_invoke",function(t,n,o){var i=1;return function(a,r){if(3===i)throw Error("Generator is already running");if(4===i){if("throw"===a)throw r;return{value:e,done:!0}}for(o.method=a,o.arg=r;;){var s=o.delegate;if(s){var l=k(s,o);if(l){if(l===h)continue;return l}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(1===i)throw i=4,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=3;var d=p(t,n,o);if("normal"===d.type){if(i=o.done?4:2,d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i=4,o.method="throw",o.arg=d.arg)}}}(t,o,new S(i||[])),!0),r}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h={};function m(){}function f(){}function g(){}var v={};l(v,a,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(E([])));b&&b!==n&&o.call(b,a)&&(v=b);var x=g.prototype=m.prototype=Object.create(v);function C(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(i,a,r,s){var l=p(e[i],e,a);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==c(u)&&o.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,r,s)}),(function(e){n("throw",e,r,s)})):t.resolve(u).then((function(e){d.value=e,r(d)}),(function(e){return n("throw",e,r,s)}))}s(l.arg)}var i;l(this,"_invoke",(function(e,o){function a(){return new t((function(t,i){n(e,o,t,i)}))}return i=i?i.then(a,a):a()}),!0)}function k(t,n){var o=n.method,i=t.i[o];if(i===e)return n.delegate=null,"throw"===o&&t.i.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=p(i,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var r=a.arg;return r?r.done?(n[t.r]=r.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function T(e){this.tryEntries.push(e)}function j(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function S(e){this.tryEntries=[[-1]],e.forEach(T,this),this.reset(!0)}function E(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(c(t)+" is not iterable")}return f.prototype=g,l(x,"constructor",g),l(g,"constructor",f),f.displayName=l(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},C(w.prototype),l(w.prototype,r,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,o,i,a){void 0===a&&(a=Promise);var r=new w(d(e,n,o,i),a);return t.isGeneratorFunction(n)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},C(x),l(x,s,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var o in t)n.unshift(o);return function e(){for(;n.length;)if((o=n.pop())in t)return e.value=o,e.done=!1,e;return e.done=!0,e}},t.values=E,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(e){r.type="throw",r.arg=t,n.next=e}for(var i=n.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],r=a[4],s=this.prev,l=a[1],d=a[2];if(-1===a[0])return o("end"),!1;if(!l&&!d)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<l)return this.method="next",this.arg=e,o(l),!0;if(s<d)return o(d),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o[0]>-1&&o[0]<=this.prev&&this.prev<o[2]){var i=o;break}}i&&("break"===e||"continue"===e)&&i[0]<=t&&t<=i[2]&&(i=null);var a=i?i[4]:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i[2],h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),j(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var o=n[4];if("throw"===o.type){var i=o.arg;j(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={i:E(t),r:n,n:o},"next"===this.method&&(this.arg=e),h}},t}function p(e,t,n,o,i,a,r){try{var s=e[a](r),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function r(e){p(a,o,i,r,s,"next",e)}function s(e){p(a,o,i,r,s,"throw",e)}r(void 0)}))}}function m(){return(m=h(u().mark((function e(t){var n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.elements.video,!(i=(null===(n=t.config.videoPlayerApi)||void 0===n?void 0:n.enabled)&&t.config.videoPlayerApi.adapter)){e.next=11;break}return e.next=5,i.isPlaying();case 5:if(t.state.wasPlayingBefore=e.sent,!t.state.wasPlayingBefore){e.next=9;break}return e.next=9,i.pause();case 9:e.next=12;break;case 11:o&&!o.paused?(t.state.wasPlayingBefore=!0,o.pause()):t.state.wasPlayingBefore=!1;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=h(u().mark((function e(t){var n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.elements.video,i=(null===(n=t.config.videoPlayerApi)||void 0===n?void 0:n.enabled)&&t.config.videoPlayerApi.adapter,t.state.wasPlayingBefore){e.next=4;break}return e.abrupt("return");case 4:if(!i){e.next=9;break}return e.next=7,i.play();case 7:e.next=18;break;case 9:if(!o){e.next=18;break}return e.prev=10,e.next=13,o.play();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.error("Error resuming video playback:",e.t0);case 18:t.state.wasPlayingBefore=!1;case 19:case"end":return e.stop()}}),e,null,[[10,15]])})))).apply(this,arguments)}var g=n(930);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,b(o.key),o)}}function b(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var x={containerId:"main-video-droppable",videoSelector:"#main-video",autoCancelTimeout:5e3,debug:!0,emojis:{quadrants:{topLeft:"🕊️",topRight:"🌟",bottomLeft:"🌧️",bottomRight:"💥"},directional:{up:"🚀",right:"👑",down:"⬇️",left:"🤫"},thoughts:{topLeft:["🌸","🎈","🌦️","🛤️"],topRight:["🌈","✨","🌤️","🎆"],bottomLeft:["🍂","🌙","☔","🗿"],bottomRight:["⚖️","🏆","⛈️","💣"]}},videoControls:{enabled:!0,rewindTime:30,forwardTime:30},callbacks:{onOverlayActivate:null,onThrowDownInitiate:null,onThrowDownConfirm:null,onThrowDownCancel:null,onVideoControl:null}};const C=function(){return e=function e(){var t,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=Object.assign({},x,o),o.emojis&&(this.config.emojis=Object.assign({},x.emojis,o.emojis),o.emojis.quadrants&&(this.config.emojis.quadrants=Object.assign({},x.emojis.quadrants,o.emojis.quadrants)),o.emojis.directional&&(this.config.emojis.directional=Object.assign({},x.emojis.directional,o.emojis.directional)),o.emojis.thoughts&&(this.config.emojis.thoughts=Object.assign({},x.emojis.thoughts,o.emojis.thoughts))),o.videoControls&&(this.config.videoControls=Object.assign({},x.videoControls,o.videoControls)),this.state={active:!1,profileBubblePosition:{x:0,y:0},currentQuadrant:null,autoCancelTimer:null,containerDimensions:{width:0,height:0},videoPlaying:!1,wasPlayingBefore:!1,recording:!1,mediaStream:null,mediaRecorder:null,recordingStartTime:0,recordingIndicator:null},this.elements={container:null,video:null,overlay:null,profileBubble:null,directionalEmojis:{},quadrantEmojis:{},videoControls:null,tooltip:null,lightBox:null,lightBoxContent:null,emojiGrid:null,commentBox:null},this.throttledResize=(t=this.handleResize.bind(this),function(){n||(t.apply(void 0,arguments),n=!0,setTimeout((function(){n=!1}),100))}),this.init()},t=[{key:"log",value:function(e,t){this.config.debug&&console.log("[QuadTap] ".concat(e),t||"")}},{key:"init",value:function(){this.log("Initializing QuadTap");var e=document.getElementById(this.config.containerId);e?(this.elements.container=e,function(){if(!document.getElementById("quad-tap-styles")){var e=document.createElement("style");e.id="quad-tap-styles",e.textContent="\n    /* Overlay Container */\n    .overlay-container {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      opacity: 0;\n      pointer-events: none;\n      transition: opacity 0.3s ease;\n      z-index: 1000;\n    }\n    \n    .overlay-container.active {\n      opacity: 1;\n      pointer-events: auto;\n    }\n    \n    /* Block pointer events on video when overlay is active */\n    .overlay-container.active + video,\n    .quad-tap-overlay.active + video {\n      pointer-events: none;\n    }\n    \n    /* Quadrants */\n    .quadrant {\n      position: absolute;\n      width: 50%;\n      height: 50%;\n      opacity: 0.7;\n      transition: opacity 0.3s ease;\n    }\n    \n    .quadrant.top-left {\n      top: 0;\n      left: 0;\n      background: linear-gradient(135deg, rgba(173, 216, 230, 0.7), rgba(173, 216, 230, 0));\n    }\n    \n    .quadrant.top-right {\n      top: 0;\n      right: 0;\n      background: linear-gradient(225deg, rgba(255, 255, 153, 0.7), rgba(255, 255, 153, 0));\n    }\n    \n    .quadrant.bottom-left {\n      bottom: 0;\n      left: 0;\n      background: linear-gradient(45deg, rgba(144, 238, 144, 0.7), rgba(144, 238, 144, 0));\n    }\n    \n    .quadrant.bottom-right {\n      bottom: 0;\n      right: 0;\n      background: linear-gradient(315deg, rgba(255, 182, 193, 0.7), rgba(255, 182, 193, 0));\n    }\n    \n    /* Profile Bubble */\n    .profile-bubble {\n      position: absolute;\n      width: 60px;\n      height: 60px;\n      border-radius: 50%;\n      background-color: rgba(128, 128, 128, 0.8);\n      border: 2px solid white;\n      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      cursor: pointer;\n      z-index: 1001;\n      transform: translate(-50%, -50%);\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n    }\n    \n    .profile-bubble:hover {\n      transform: translate(-50%, -50%) scale(1.1);\n      box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);\n    }\n    \n    /* Light-Box Modal */\n    .td-modal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(0, 0, 0, 0.7);\n      z-index: 2000;\n      justify-content: center;\n      align-items: center;\n      opacity: 0;\n      transition: opacity 0.3s ease;\n    }\n    \n    .td-modal.active {\n      display: flex;\n      opacity: 1;\n    }\n    \n    .td-modal-content {\n      background-color: white;\n      padding: 20px;\n      border-radius: 10px;\n      width: 80%;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      position: relative;\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);\n    }\n    \n    .td-modal-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 20px;\n      padding-bottom: 10px;\n      border-bottom: 1px solid #eee;\n    }\n    \n    .td-modal-header h4 {\n      margin: 0;\n      font-size: 1.5rem;\n      color: #333;\n    }\n    \n    .td-close-btn, .td-pause-play-btn {\n      background: none;\n      border: none;\n      font-size: 1.5rem;\n      cursor: pointer;\n      color: #999;\n      transition: color 0.2s ease;\n    }\n    \n    .td-close-btn {\n      margin-left: 10px;\n    }\n    \n    .td-pause-play-btn {\n      margin-left: auto;\n    }\n    \n    .td-close-btn:hover, .td-pause-play-btn:hover {\n      color: #333;\n    }\n    \n    /* Emoji Grid */\n    .emoji-grid {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      grid-template-rows: 1fr 1fr;\n      gap: 10px;\n      width: 100%;\n    }\n    \n    .emoji-quadrant {\n      padding: 10px;\n      border-radius: 8px;\n    }\n    \n    .emoji-quadrant.top-left {\n      background-color: rgba(173, 216, 230, 0.3);\n    }\n    \n    .emoji-quadrant.top-right {\n      background-color: rgba(255, 255, 153, 0.3);\n    }\n    \n    .emoji-quadrant.bottom-left {\n      background-color: rgba(144, 238, 144, 0.3);\n    }\n    \n    .emoji-quadrant.bottom-right {\n      background-color: rgba(255, 182, 193, 0.3);\n    }\n    \n    .emoji-row {\n      display: flex;\n      justify-content: space-around;\n      margin-bottom: 10px;\n      background-color: transparent;\n    }\n    \n    .emoji-cell {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background-color: transparent;\n    }\n    \n    .thought-emoji {\n      font-size: 2rem;\n      cursor: pointer;\n      padding: 5px;\n      border-radius: 5px;\n      transition: transform 0.2s ease, background-color 0.2s ease;\n    }\n    \n    .thought-emoji:hover {\n      transform: scale(1.2);\n      background-color: rgba(255, 255, 255, 0.5);\n    }\n    \n    .thought-emoji.selected {\n      background-color: rgba(255, 255, 255, 0.8);\n      box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);\n    }\n    \n    /* Tooltip */\n    .tooltip {\n      position: absolute;\n      background-color: rgba(0, 0, 0, 0.7);\n      color: white;\n      padding: 5px 10px;\n      border-radius: 5px;\n      font-size: 0.8rem;\n      pointer-events: none;\n      z-index: 1002;\n      transition: opacity 0.3s ease;\n    }\n    \n    /* Comment Box */\n    .comment-box {\n      margin-top: 20px;\n      width: 100%;\n    }\n    \n    .comment-box textarea {\n      width: 100%;\n      padding: 10px;\n      border: 1px solid #ddd;\n      border-radius: 5px;\n      resize: vertical;\n      min-height: 80px;\n      font-family: inherit;\n    }\n    \n    /* Media Buttons */\n    .media-buttons {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 10px;\n      margin-top: 10px;\n      margin-bottom: 10px;\n    }\n    \n    .media-button {\n      padding: 8px 12px;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-weight: bold;\n      transition: background-color 0.2s ease;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    \n    .upload-button {\n      background-color: #3498db;\n      color: white;\n    }\n    \n    .upload-button:hover {\n      background-color: #2980b9;\n    }\n    \n    .capture-button {\n      background-color: #e74c3c;\n      color: white;\n    }\n    \n    .capture-button:hover {\n      background-color: #c0392b;\n    }\n    \n    .uploaded-file-name {\n      margin-top: 5px;\n      padding: 5px;\n      background-color: #f1f1f1;\n      border-radius: 3px;\n      font-size: 0.9rem;\n      width: 100%;\n    }\n    \n    .recording-message {\n      margin-top: 5px;\n      padding: 5px;\n      background-color: #f8d7da;\n      color: #721c24;\n      border-radius: 3px;\n      font-size: 0.9rem;\n      width: 100%;\n    }\n    \n    .recording-indicator {\n      animation: pulse 1.5s infinite;\n    }\n    \n    @keyframes pulse {\n      0% { opacity: 1; }\n      50% { opacity: 0.5; }\n      100% { opacity: 1; }\n    }\n    \n    /* Action Buttons */\n    .action-buttons {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 20px;\n      gap: 10px;\n    }\n    \n    .action-button {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-weight: bold;\n      transition: background-color 0.2s ease;\n    }\n    \n    .save-button {\n      background-color: #4CAF50;\n      color: white;\n    }\n    \n    .save-button:hover {\n      background-color: #45a049;\n    }\n    \n    .cancel-button {\n      background-color: #f44336;\n      color: white;\n    }\n    \n    .cancel-button:hover {\n      background-color: #d32f2f;\n    }\n  ",document.head.appendChild(e)}}(),this.createOverlayElements(),this.createLightBoxElements(),this.bindEventHandlers(),this.log("QuadTap initialized successfully")):this.log("Container not found",this.config.containerId)}},{key:"createOverlayElements",value:function(){var e=i("div",{className:"quad-tap-overlay",styles:{display:"none"}}),t=i("div",{className:"quadrant top-left"}),n=i("div",{className:"quadrant top-right"}),o=i("div",{className:"quadrant bottom-left"}),a=i("div",{className:"quadrant bottom-right"}),r=i("div",{className:"profile-bubble",styles:{display:"none"}}),s=i("div",{className:"directional-emoji up",text:this.config.emojis.directional.up,styles:{display:"none"}}),l=i("div",{className:"directional-emoji right",text:this.config.emojis.directional.right,styles:{display:"none"}}),d=i("div",{className:"directional-emoji down",text:this.config.emojis.directional.down,styles:{display:"none"}}),c=i("div",{className:"directional-emoji left",text:this.config.emojis.directional.left,styles:{display:"none"}}),u=i("div",{className:"quadrant-emoji top-left",text:this.config.emojis.quadrants.topLeft,styles:{display:"none"}}),p=i("div",{className:"quadrant-emoji top-right",text:this.config.emojis.quadrants.topRight,styles:{display:"none"}}),h=i("div",{className:"quadrant-emoji bottom-left",text:this.config.emojis.quadrants.bottomLeft,styles:{display:"none"}}),m=i("div",{className:"quadrant-emoji bottom-right",text:this.config.emojis.quadrants.bottomRight,styles:{display:"none"}}),f=this.createVideoControls(),g=i("div",{className:"tooltip",text:"Tap elsewhere to cancel",styles:{display:"none"}});e.appendChild(t),e.appendChild(n),e.appendChild(o),e.appendChild(a),e.appendChild(s),e.appendChild(l),e.appendChild(d),e.appendChild(c),e.appendChild(u),e.appendChild(p),e.appendChild(h),e.appendChild(m),e.appendChild(r),e.appendChild(f),e.appendChild(g),this.elements.container.appendChild(e),this.elements.overlay=e,this.elements.profileBubble=r,this.elements.directionalEmojis={up:s,right:l,down:d,left:c},this.elements.quadrantEmojis={topLeft:u,topRight:p,bottomLeft:h,bottomRight:m},this.elements.videoControls=f,this.elements.tooltip=g}},{key:"createVideoControls",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.config.videoControls.enabled)return i("div",{styles:{display:"none"}});var n=document.querySelector(this.config.videoSelector),o=(0,g.createControlStrip)({overlay:t?document.createElement("div"):this.elements.overlay||document.createElement("div"),onPlay:function(){n&&(n.play(),e.elements.videoControls&&(0,g.updatePlayPauseButton)(e.elements.videoControls,!0),e.elements.lightboxControlStrip&&(0,g.updatePlayPauseButton)(e.elements.lightboxControlStrip,!0),e.updateVideoTimeDisplay()),e.config.callbacks.onVideoControl&&e.config.callbacks.onVideoControl("play",n?n.currentTime:0)},onPause:function(){n&&(n.pause(),e.elements.videoControls&&(0,g.updatePlayPauseButton)(e.elements.videoControls,!1),e.elements.lightboxControlStrip&&(0,g.updatePlayPauseButton)(e.elements.lightboxControlStrip,!1),e.updateVideoTimeDisplay()),e.config.callbacks.onVideoControl&&e.config.callbacks.onVideoControl("pause",n?n.currentTime:0)},onRewind:function(){n&&(n.currentTime=Math.max(0,n.currentTime-e.config.videoControls.rewindTime),e.updateVideoTimeDisplay()),e.config.callbacks.onVideoControl&&e.config.callbacks.onVideoControl("rewind",n?n.currentTime:0)},onForward:function(){n&&(n.currentTime=Math.min(n.duration,n.currentTime+e.config.videoControls.forwardTime),e.updateVideoTimeDisplay()),e.config.callbacks.onVideoControl&&e.config.callbacks.onVideoControl("forward",n?n.currentTime:0)},onShare:t?function(){navigator.share?navigator.share({title:"Shared Video",text:"Check out this video!",url:window.location.href}).catch((function(e){console.error("Share failed:",e)})):alert("Share feature not supported by your browser"),e.config.callbacks.onVideoControl&&e.config.callbacks.onVideoControl("share",n?n.currentTime:0)}:void 0,onCopyUrl:t?function(){var t=window.location.href;navigator.clipboard.writeText(t).then((function(){alert("URL copied to clipboard")})).catch((function(e){console.error("Copy failed:",e);var n=document.createElement("input");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),alert("URL copied to clipboard")})),e.config.callbacks.onVideoControl&&e.config.callbacks.onVideoControl("copyurl",n?n.currentTime:0)}:void 0,rewindTime:this.config.videoControls.rewindTime,forwardTime:this.config.videoControls.forwardTime,debug:this.config.debug,showAllButtons:t,isLightbox:t});return t||(o.style.display="none"),o}},{key:"createLightboxControlStrip",value:function(){var e=this;if(!this.config.videoControls.enabled)return i("div",{styles:{display:"none"}});var t=i("div",{className:"td-lightbox-controls",styles:{width:"100%",padding:"15px 0",marginTop:"20px",marginBottom:"20px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"column"}}),n=i("div",{className:"td-video-slider-container",styles:{width:"100%",padding:"0 10px",marginBottom:"10px",display:"flex",flexDirection:"column"}}),o=i("div",{className:"td-time-display",styles:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#fff",marginBottom:"5px"}}),a=i("span",{className:"td-current-time",text:"0:00"}),r=i("span",{className:"td-duration",text:"0:00"});o.appendChild(a),o.appendChild(r);var s=i("div",{className:"td-slider-container",styles:{width:"100%",height:"20px",display:"flex",alignItems:"center"}}),l=document.querySelector(this.config.videoSelector),d=i("input",{className:"td-video-slider",attributes:{type:"range",min:"0",max:"100",value:"0",step:"0.1"},styles:{width:"100%",margin:"0",cursor:"pointer"},events:{input:function(t){if(l){var n=t.target.value/100*l.duration;l.currentTime=n,e.updateVideoTimeDisplay()}}}});s.appendChild(d),n.appendChild(o),n.appendChild(s);var c=this.createVideoControls(!0);return this.elements.currentTimeElement=a,this.elements.durationElement=r,this.elements.videoSlider=d,this.elements.lightboxControlStrip=c,t.appendChild(n),t.appendChild(c),t}},{key:"createLightBoxElements",value:function(){var e=this,t=i("div",{id:"throwdown-modal",className:"td-modal"}),n=i("div",{className:"td-modal-content"}),o=i("div",{className:"td-modal-header"}),a=i("h4",{text:"Share Your Thoughts"}),r=i("button",{className:"td-close-btn",html:"&times;",events:{click:function(t){e.closeLightBox(),t.stopPropagation()}}}),s=i("div",{className:"td-video-info",styles:{fontSize:"14px",color:"#888",marginRight:"10px"}});o.appendChild(a),o.appendChild(s),o.appendChild(r),this.createVideoTimeSlider();var d=this.createEmojiGrid(),c=i("div",{className:"comment-box"}),u=i("textarea",{placeholder:"Add a comment (optional)",attributes:{rows:3,maxlength:500},events:{input:function(t){var n=t.target.value,o=e.extractUrlFromText(n);o&&l("extractedUrl",o),l("comment",n),e.saveEventToHistory({type:"comment_update",comment:n,extractedUrl:o})}}});c.appendChild(u);var p=i("div",{className:"media-buttons"}),h=i("button",{className:"media-button upload-button",text:"📤 Upload Video",events:{click:function(t){var n=i("input",{attributes:{type:"file",accept:"video/*"},events:{change:function(t){var n=t.target.files[0];if(n){e.log("Video file selected",n.name),l("uploadedVideo",n.name);var o=document.createElement("div");o.className="uploaded-file-name",o.textContent="Selected: ".concat(n.name),p.appendChild(o),e.saveEventToHistory({type:"video_upload",fileName:n.name,fileSize:n.size,fileType:n.type})}}}});document.body.appendChild(n),n.click(),document.body.removeChild(n),t.stopPropagation()}}}),m=i("button",{className:"media-button capture-button",text:"📹 Record Video",events:{click:function(t){if(e.state.recording){e.stopRecording(),m.textContent="📹 Record Video";var n=document.createElement("div");n.className="recording-message",n.textContent="Recording saved",p.appendChild(n),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n)}),3e3)}else e.startRecording(),m.textContent="⏹️ Stop Recording";t.stopPropagation()}}});p.appendChild(h),p.appendChild(m),c.appendChild(p);var f=i("div",{className:"action-buttons"}),g=i("button",{className:"action-button cancel-button",text:"Cancel",events:{click:function(t){e.closeLightBox(),t.stopPropagation()}}}),v=i("button",{className:"action-button save-button",text:"Save",events:{click:function(t){e.saveThrowDown(),t.stopPropagation()}}});f.appendChild(g),f.appendChild(v),n.appendChild(o),n.appendChild(d);var y=i("div",{styles:{width:"100%",height:"20px",clear:"both"}});n.appendChild(y);var b=this.createLightboxControlStrip();n.appendChild(b),n.appendChild(c),n.appendChild(f),t.appendChild(n),document.body.appendChild(t),this.elements.lightBox=t,this.elements.lightBoxContent=n,this.elements.videoInfoDisplay=s,this.elements.emojiGrid=d,this.elements.commentBox=c}},{key:"createEmojiGrid",value:function(){var e=i("div",{className:"emoji-grid",styles:{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"1fr 1fr",gap:"10px",width:"100%"}}),t=i("div",{className:"emoji-quadrant top-left",styles:{gridRow:"1",gridColumn:"1"}}),n=i("div",{className:"emoji-quadrant top-right",styles:{gridRow:"1",gridColumn:"2"}}),o=i("div",{className:"emoji-quadrant bottom-left",styles:{gridRow:"2",gridColumn:"1"}}),a=i("div",{className:"emoji-quadrant bottom-right",styles:{gridRow:"2",gridColumn:"2"}});return this.createEmojiTable(t,this.config.emojis.thoughts.topLeft,"top-left"),this.createEmojiTable(n,this.config.emojis.thoughts.topRight,"top-right"),this.createEmojiTable(o,this.config.emojis.thoughts.bottomLeft,"bottom-left"),this.createEmojiTable(a,this.config.emojis.thoughts.bottomRight,"bottom-right"),e.appendChild(t),e.appendChild(n),e.appendChild(o),e.appendChild(a),e}},{key:"createEmojiTable",value:function(e,t,n){var o=this,a=i("div",{className:"emoji-row"}),r=i("div",{className:"emoji-cell"});if(t[0]){var s=i("div",{className:"thought-emoji",text:t[0],attributes:{"data-emoji":t[0],"data-quadrant":n,"data-index":0},events:{click:function(e){o.selectEmoji(s,t[0],n,0)}}});r.appendChild(s)}var l=i("div",{className:"emoji-cell"});if(t[1]){var d=i("div",{className:"thought-emoji",text:t[1],attributes:{"data-emoji":t[1],"data-quadrant":n,"data-index":1},events:{click:function(e){o.selectEmoji(d,t[1],n,1)}}});l.appendChild(d)}a.appendChild(r),a.appendChild(l);var c=i("div",{className:"emoji-row"}),u=i("div",{className:"emoji-cell"});if(t[2]){var p=i("div",{className:"thought-emoji",text:t[2],attributes:{"data-emoji":t[2],"data-quadrant":n,"data-index":2},events:{click:function(e){o.selectEmoji(p,t[2],n,2)}}});u.appendChild(p)}var h=i("div",{className:"emoji-cell"});if(t[3]){var m=i("div",{className:"thought-emoji",text:t[3],attributes:{"data-emoji":t[3],"data-quadrant":n,"data-index":3},events:{click:function(e){o.selectEmoji(m,t[3],n,3)}}});h.appendChild(m)}c.appendChild(u),c.appendChild(h),e.appendChild(a),e.appendChild(c)}},{key:"extractUrlFromText",value:function(e){if(!e)return null;var t=e.match(/(https?:\/\/[^\s]+)/g);return t&&t.length>0?t[0]:null}},{key:"saveEventToHistory",value:function(e){e.timestamp=(new Date).toISOString(),e.context={profileBubblePosition:this.state.profileBubblePosition,currentQuadrant:this.state.currentQuadrant,containerDimensions:this.state.containerDimensions};var t=[];try{var n=localStorage.getItem("quadTapEvents");n&&(t=JSON.parse(n))}catch(e){this.log("Error parsing stored events",e)}t.push(e),localStorage.setItem("quadTapEvents",JSON.stringify(t)),localStorage.setItem("quadTapCurrentEvent",JSON.stringify(e)),this.log("Event saved to history",e)}},{key:"selectEmoji",value:function(e,t,n,o){this.log("Emoji selected",{emoji:t,quadrant:n,index:o}),this.elements.emojiGrid.querySelectorAll(".thought-emoji").forEach((function(e){return e.classList.remove("selected")})),e.classList.add("selected"),l("selectedEmoji",t),l("selectedQuadrant",n),l("selectedIndex",o),this.saveEventToHistory({type:"emoji_selected",emoji:t,quadrant:n,index:o});var i=document.querySelector(this.config.videoSelector);if(i&&(l("videoTime",i.currentTime),l("videoId",i.getAttribute("data-video-id")||"unknown")),l("positionX",this.state.profileBubblePosition.x),l("positionY",this.state.profileBubblePosition.y),this.config.callbacks.onThrowDownConfirm){var a=i?{currentTime:i.currentTime,videoId:i.getAttribute("data-video-id")||"unknown",duration:i.duration}:null;this.config.callbacks.onThrowDownConfirm(n,this.state.profileBubblePosition.x,this.state.profileBubblePosition.y,a)}}},{key:"saveThrowDown",value:function(){this.log("Saving throw-down");var e=this.elements.commentBox.querySelector("textarea"),t=e?e.value:"",n=this.extractUrlFromText(t);l("comment",t),n&&l("extractedUrl",n),l("timestamp",Date.now());var o=document.querySelector(this.config.videoSelector),i={};o&&(Array.from(o.attributes).filter((function(e){return e.name.startsWith("data-")})).forEach((function(e){var t=e.name.replace("data-","");i[t]=e.value})),i.duration=o.duration||0,i.currentTime=o.currentTime||0,i.paused=o.paused,i.muted=o.muted,i.volume=o.volume,i.playbackRate=o.playbackRate,i.videoWidth=o.videoWidth,i.videoHeight=o.videoHeight,i.src=o.currentSrc||o.src);var a={selectedEmoji:d("selectedEmoji",""),selectedQuadrant:d("selectedQuadrant",""),selectedIndex:d("selectedIndex",-1),comment:t,extractedUrl:n||d("extractedUrl",""),positionX:this.state.profileBubblePosition.x,positionY:this.state.profileBubblePosition.y,quadrant:this.state.currentQuadrant,videoId:d("videoId",o&&o.getAttribute("data-video-id")||"unknown"),videoTime:d("videoTime",o?o.currentTime:0),videoMetadata:i,containerId:this.config.containerId,containerWidth:this.state.containerDimensions.width,containerHeight:this.state.containerDimensions.height,timestamp:Date.now(),timezoneOffset:(new Date).getTimezoneOffset(),locale:navigator.language||"en-US",userAgent:navigator.userAgent,platform:navigator.platform,url:window.location.href,referrer:document.referrer,title:document.title};!function(e){try{for(var t in e)l(t,e[t]);return l("timestamp",Date.now()),!0}catch(e){return console.error("[QuadTap] Error saving throw-down context:",e),!1}}(a),this.closeLightBox(),this.log("Throw-down saved",a)}},{key:"bindEventHandlers",value:function(){var e=this;this.elements.video=document.querySelector(this.config.videoSelector),this.elements.container.addEventListener("click",(function(t){if(t.preventDefault(),t.stopPropagation(),!t.target.closest(".video-control-button"))if(e.state.active)t.target===e.elements.profileBubble||e.elements.profileBubble.contains(t.target)?e.openLightBox():e.deactivateOverlay();else{var n=e.elements.container.getBoundingClientRect(),o=t.clientX-n.left,i=t.clientY-n.top;e.activateOverlay(o,i)}})),this.elements.profileBubble.addEventListener("click",(function(t){e.state.active&&(e.openLightBox(),t.stopPropagation())})),this.elements.lightBox.addEventListener("click",(function(t){t.target===e.elements.lightBox&&e.closeLightBox()})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&(e.elements.lightBox.classList.contains("active")?e.closeLightBox():e.state.active&&e.deactivateOverlay())})),this.elements.video&&(this.elements.video.addEventListener("play",(function(){e.state.videoPlaying=!0})),this.elements.video.addEventListener("pause",(function(){e.state.videoPlaying=!1}))),window.addEventListener("resize",this.throttledResize),this.updateContainerDimensions()}},{key:"handleResize",value:function(){if(this.state.active){this.updateContainerDimensions();var e=this.state.containerDimensions.width*this.state.profileBubblePosition.x,t=this.state.containerDimensions.height*this.state.profileBubblePosition.y;a(this.elements.profileBubble,e,t),this.positionDirectionalEmojis(e,t),this.positionQuadrantEmojis(),this.positionVideoControls(),this.positionTooltip()}}},{key:"updateContainerDimensions",value:function(){if(this.elements.container){var e=this.elements.container.getBoundingClientRect();this.state.containerDimensions={width:e.width,height:e.height}}}},{key:"activateOverlay",value:function(e,t){var n=this;this.log("Activating overlay",{x:e,y:t});var o=e/this.state.containerDimensions.width,i=t/this.state.containerDimensions.height;this.state.profileBubblePosition={x:o,y:i},this.state.currentQuadrant=function(e,t,n){var o=n.getBoundingClientRect(),i=o.width/2,a=o.height/2;return e<i?t<a?"top-left":"bottom-left":t<a?"top-right":"bottom-right"}(e,t,this.elements.container),this.log("Current quadrant",this.state.currentQuadrant),this.elements.overlay.style.display="block",setTimeout((function(){n.elements.overlay.classList.add("active")}),10),this.elements.profileBubble.style.display="flex";var r=this.state.containerDimensions.width*this.state.profileBubblePosition.x,s=this.state.containerDimensions.height*this.state.profileBubblePosition.y;a(this.elements.profileBubble,r,s),this.positionDirectionalEmojis(e,t),this.positionQuadrantEmojis(),this.positionVideoControls(),this.positionTooltip(),this.state.active=!0,this.config.autoCancelTimeout>0&&(this.state.autoCancelTimer=setTimeout((function(){n.deactivateOverlay()}),this.config.autoCancelTimeout)),this.config.callbacks.onOverlayActivate&&this.config.callbacks.onOverlayActivate(e,t)}},{key:"positionDirectionalEmojis",value:function(e,t){var n=this.state.containerDimensions,o=n.width,i=n.height,a=t,r=o-e,s=i-t,l=e,d=o/2,c=.1*i,u=.9*o,p=i/2,h=o/2,m=.9*i,f=.1*o,g=i/2,v=Math.sqrt(Math.pow(e-d,2)+Math.pow(t-c,2)),y=Math.sqrt(Math.pow(e-u,2)+Math.pow(t-p,2)),b=Math.sqrt(Math.pow(e-h,2)+Math.pow(t-m,2)),x=Math.sqrt(Math.pow(e-f,2)+Math.pow(t-g,2)),C=Math.sqrt(Math.pow(o,2)+Math.pow(i,2)),w=.8+Math.max(0,1.2*(1-v/C))+Math.max(0,.8*(1-a/(i/2))),k=.8+Math.max(0,1.2*(1-y/C))+Math.max(0,.8*(1-r/(o/2))),T=.8+Math.max(0,1.2*(1-b/C))+Math.max(0,.8*(1-s/(i/2))),j=.8+Math.max(0,1.2*(1-x/C))+Math.max(0,.8*(1-l/(o/2))),S=this.elements.directionalEmojis.up;S.style.display="block",S.style.position="absolute",S.style.top="10%",S.style.left="50%",S.style.transform="translate(-50%, 0) scale(".concat(w,")"),S.style.fontSize="2rem",S.style.opacity="0.8";var E=this.elements.directionalEmojis.right;E.style.display="block",E.style.position="absolute",E.style.top="50%",E.style.right="10%",E.style.transform="translate(0, -50%) scale(".concat(k,")"),E.style.fontSize="2rem",E.style.opacity="0.8";var B=this.elements.directionalEmojis.down;B.style.display="block",B.style.position="absolute",B.style.bottom="10%",B.style.left="50%",B.style.transform="translate(-50%, 0) scale(".concat(T,")"),B.style.fontSize="2rem",B.style.opacity="0.8";var P=this.elements.directionalEmojis.left;P.style.display="block",P.style.position="absolute",P.style.top="50%",P.style.left="10%",P.style.transform="translate(0, -50%) scale(".concat(j,")"),P.style.fontSize="2rem",P.style.opacity="0.8"}},{key:"positionQuadrantEmojis",value:function(){var e="2.5rem",t="0.6",n=this.elements.quadrantEmojis.topLeft;n.style.display="block",n.style.position="absolute",n.style.top="8%",n.style.left="8%",n.style.transform="translate(-50%, -50%)",n.style.fontSize=e,n.style.opacity=t;var o=this.elements.quadrantEmojis.topRight;o.style.display="block",o.style.position="absolute",o.style.top="8%",o.style.right="8%",o.style.transform="translate(50%, -50%)",o.style.fontSize=e,o.style.opacity=t;var i=this.elements.quadrantEmojis.bottomLeft;i.style.display="block",i.style.position="absolute",i.style.bottom="8%",i.style.left="8%",i.style.transform="translate(-50%, 50%)",i.style.fontSize=e,i.style.opacity=t;var a=this.elements.quadrantEmojis.bottomRight;if(a.style.display="block",a.style.position="absolute",a.style.bottom="8%",a.style.right="8%",a.style.transform="translate(50%, 50%)",a.style.fontSize=e,a.style.opacity=t,this.state.currentQuadrant){var r="3.5rem",s="0.8";switch(this.state.currentQuadrant){case"top-left":n.style.fontSize=r,n.style.opacity=s;break;case"top-right":o.style.fontSize=r,o.style.opacity=s;break;case"bottom-left":i.style.fontSize=r,i.style.opacity=s;break;case"bottom-right":a.style.fontSize=r,a.style.opacity=s}}}},{key:"positionVideoControls",value:function(){this.config.videoControls.enabled&&(this.elements.videoControls.style.display="flex")}},{key:"positionTooltip",value:function(){if(this.config.tooltip&&!1!==this.config.tooltip.enabled){var e=this.elements.tooltip;switch(e.style.display="block",e.style.position="absolute",e.style.zIndex="1001",this.config.tooltip.text&&(e.textContent=this.config.tooltip.text),this.config.tooltip.position||"above-controls"){case"above-controls":default:e.style.top="40%",e.style.left="50%",e.style.transform="translate(-50%, -50%)";break;case"below-controls":e.style.top="60%",e.style.left="50%",e.style.transform="translate(-50%, -50%)";break;case"on-bubble":var t=this.elements.profileBubble.getBoundingClientRect(),n=this.elements.overlay.getBoundingClientRect(),o=(t.top-n.top)/n.height*100;e.style.top="".concat(o-10,"%"),e.style.left="50%",e.style.transform="translate(-50%, -100%)"}if(this.config.tooltip.style){var i=this.config.tooltip.style;i.backgroundColor&&(e.style.backgroundColor=i.backgroundColor),i.color&&(e.style.color=i.color),i.padding&&(e.style.padding=i.padding),i.borderRadius&&(e.style.borderRadius=i.borderRadius)}else e.style.textAlign="center",e.style.backgroundColor="rgba(0, 0, 0, 0.7)",e.style.color="white",e.style.padding="8px 12px",e.style.borderRadius="4px"}}},{key:"controlVideo",value:function(e){this.log("Controlling video",e);var t=document.querySelector(this.config.videoSelector);if(t){switch(e){case"rewind":t.currentTime=Math.max(0,t.currentTime-this.config.videoControls.rewindTime);break;case"playpause":t.paused?t.play():t.pause();break;case"forward":t.currentTime=Math.min(t.duration,t.currentTime+this.config.videoControls.forwardTime);break;case"share":navigator.share?navigator.share({title:"Shared Video",text:"Check out this video!",url:window.location.href}).catch((function(e){console.error("Share failed:",e)})):alert("Share feature not supported by your browser")}this.config.callbacks.onVideoControl&&this.config.callbacks.onVideoControl(e,t.currentTime)}else this.log("Video element not found")}},{key:"deactivateOverlay",value:function(){var e=this;this.log("Deactivating overlay"),this.elements.overlay.classList.remove("active"),setTimeout((function(){e.state.active||(e.elements.overlay.style.display="none",e.elements.profileBubble.style.display="none",Object.values(e.elements.directionalEmojis).forEach((function(e){e.style.display="none"})),Object.values(e.elements.quadrantEmojis).forEach((function(e){e.style.display="none"})),e.elements.videoControls.style.display="none",e.elements.tooltip.style.display="none")}),300),this.state.active=!1,this.state.autoCancelTimer&&(clearTimeout(this.state.autoCancelTimer),this.state.autoCancelTimer=null),this.config.callbacks.onThrowDownCancel&&this.config.callbacks.onThrowDownCancel(this.state.currentQuadrant),this.log("Overlay deactivated")}},{key:"createVideoTimeSlider",value:function(){var e=this;if(!this.config.videoControls.enabled)return i("div",{styles:{display:"none"}});var t=document.querySelector(this.config.videoSelector),n=i("div",{className:"td-video-slider-container",styles:{width:"100%",padding:"15px 0",marginTop:"20px",marginBottom:"20px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"column"}}),o=i("div",{className:"td-time-display",styles:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#fff",marginBottom:"5px"}}),a=i("span",{className:"td-current-time",text:"0:00"}),r=i("span",{className:"td-duration",text:"0:00"});o.appendChild(a),o.appendChild(r);var s=i("div",{className:"td-slider-container",styles:{width:"100%",height:"20px",display:"flex",alignItems:"center"}}),l=i("input",{className:"td-video-slider",attributes:{type:"range",min:"0",max:"100",value:"0",step:"0.1"},styles:{width:"100%",margin:"0",cursor:"pointer"},events:{input:function(n){if(t){var o=n.target.value/100*t.duration;t.currentTime=o,e.updateVideoTimeDisplay()}}}});return s.appendChild(l),n.appendChild(o),n.appendChild(s),this.elements.currentTimeElement=a,this.elements.durationElement=r,this.elements.videoSlider=l,n}},{key:"openLightBox",value:function(){var e=this;this.log("Opening light-box"),this.elements.lightBox.classList.add("active"),this.state.autoCancelTimer&&(clearTimeout(this.state.autoCancelTimer),this.state.autoCancelTimer=null);var t=this.config.videoPlayerApi&&this.config.videoPlayerApi.enabled&&this.config.videoPlayerApi.adapter;if(this.state.wasPlayingBefore=!!t&&t.isPlaying(),!t){var n=document.querySelector(this.config.videoSelector);this.state.wasPlayingBefore=!!n&&!n.paused}if(this.elements.videoControls&&this.config.videoControls.enabled&&(this.elements.videoControls.parentNode&&this.elements.videoControls.parentNode.removeChild(this.elements.videoControls),this.elements.lightBoxContent)){var o=this.elements.emojiGrid;o&&o.nextSibling?this.elements.lightBoxContent.insertBefore(this.elements.videoControls,o.nextSibling.nextSibling):this.elements.lightBoxContent.appendChild(this.elements.videoControls),(0,g.applyControlStripLayout)(this.elements.videoControls,!0),this.elements.videoControls.style.display="flex"}this.updateVideoTimeDisplay(),this.videoTimeUpdateInterval=setInterval((function(){e.updateVideoTimeDisplay()}),1e3);var i=document.querySelector(this.config.videoSelector),a=!!i&&!i.paused;this.config.videoControls&&this.config.videoControls.pauseOnLightboxOnly?(this.log("Pausing video on lightbox open (pauseOnLightboxOnly=true)"),function(e){m.apply(this,arguments)}(this),this.elements.videoControls&&(0,g.updatePlayPauseButton)(this.elements.videoControls,!1)):(this.log("Not pausing video on lightbox open (pauseOnLightboxOnly=false)"),this.elements.videoControls&&(0,g.updatePlayPauseButton)(this.elements.videoControls,a)),this.config.callbacks.onThrowDownInitiate&&this.config.callbacks.onThrowDownInitiate(this.state.currentQuadrant,this.state.profileBubblePosition.x,this.state.profileBubblePosition.y)}},{key:"closeLightBox",value:function(){var e=this;this.log("Closing light-box"),this.elements.lightBox.classList.remove("active"),this.videoTimeUpdateInterval&&(clearInterval(this.videoTimeUpdateInterval),this.videoTimeUpdateInterval=null),this.elements.videoControls&&this.config.videoControls.enabled&&(this.elements.videoControls.parentNode&&this.elements.videoControls.parentNode.removeChild(this.elements.videoControls),this.elements.overlay&&(this.elements.overlay.appendChild(this.elements.videoControls),(0,g.applyControlStripLayout)(this.elements.videoControls,!1),this.elements.videoControls.style.display="none")),this.config.videoPlayerApi&&this.config.videoPlayerApi.enabled&&this.config.videoPlayerApi.adapter,this.config.videoControls&&this.config.videoControls.pauseOnLightboxOnly?(this.log("Resuming video on lightbox close (pauseOnLightboxOnly=true)"),setTimeout((function(){!function(e){f.apply(this,arguments)}(e),e.elements.videoControls&&e.state.wasPlayingBefore&&(0,g.updatePlayPauseButton)(e.elements.videoControls,!0)}),100)):this.log("Not resuming video on lightbox close (pauseOnLightboxOnly=false)"),this.state.wasPlayingBefore=!1,this.deactivateOverlay()}},{key:"updateVideoTimeDisplay",value:function(){if(this.elements.videoInfoDisplay){var e=document.querySelector(this.config.videoSelector);if(e){var t=function(e){if(isNaN(e)||!isFinite(e))return"0:00";var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t,":").concat(n<10?"0":"").concat(n)},n=t(e.currentTime),o=t(e.duration);if(this.elements.videoInfoDisplay.textContent="".concat(n," / ").concat(o),this.elements.currentTimeElement&&(this.elements.currentTimeElement.textContent=n),this.elements.durationElement&&(this.elements.durationElement.textContent=o),this.elements.videoSlider&&e.duration){var i=e.currentTime/e.duration*100;this.elements.videoSlider.value=i}}}}},{key:"startRecording",value:function(){var e=this;if(this.log("Starting video recording"),this.state.recording=!0,!navigator.mediaDevices||!window.MediaRecorder)return this.log("MediaRecorder API not supported"),alert("Video recording is not supported in your browser"),void(this.state.recording=!1);navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){e.state.mediaStream=t,e.state.mediaRecorder=new MediaRecorder(t);var n=[];e.state.mediaRecorder.ondataavailable=function(e){e.data.size>0&&n.push(e.data)},e.state.mediaRecorder.onstop=function(){var t=new Blob(n,{type:"video/webm"});l("recordedVideo",URL.createObjectURL(t)),e.saveEventToHistory({type:"video_recording",size:t.size,duration:Date.now()-e.state.recordingStartTime}),e.state.mediaStream.getTracks().forEach((function(e){return e.stop()})),e.state.mediaStream=null,e.state.mediaRecorder=null,e.state.recording=!1},e.state.mediaRecorder.start(),e.state.recordingStartTime=Date.now();var o=document.createElement("div");o.className="recording-indicator",o.textContent="🔴 Recording...",o.style.position="absolute",o.style.top="10px",o.style.right="10px",o.style.backgroundColor="rgba(255, 0, 0, 0.7)",o.style.color="white",o.style.padding="5px 10px",o.style.borderRadius="4px",o.style.zIndex="1002",e.elements.lightBoxContent.appendChild(o),e.state.recordingIndicator=o})).catch((function(t){e.log("Error accessing media devices",t),alert("Could not access camera and microphone"),e.state.recording=!1}))}},{key:"stopRecording",value:function(){this.log("Stopping video recording"),this.state.mediaRecorder&&this.state.recording&&(this.state.mediaRecorder.stop(),this.state.recordingIndicator&&this.state.recordingIndicator.parentNode&&this.state.recordingIndicator.parentNode.removeChild(this.state.recordingIndicator))}},{key:"toggleVideoPause",value:function(){var e=this;this.log("Toggling video pause/play state");var t=this.config.videoPlayerApi&&this.config.videoPlayerApi.enabled&&this.config.videoPlayerApi.adapter,n=document.querySelector(this.config.videoSelector);if(t)t.isPlaying().then((function(n){if(n){t.pause();var o=e.elements.lightBox.querySelector(".td-pause-play-btn");o&&(o.textContent="▶️")}else{t.play();var i=e.elements.lightBox.querySelector(".td-pause-play-btn");i&&(i.textContent="⏸️")}}));else if(n)if(n.paused)n.play().then((function(){var t=e.elements.lightBox.querySelector(".td-pause-play-btn");t&&(t.textContent="⏸️")})).catch((function(t){e.log("Error playing video",t)}));else{n.pause();var o=this.elements.lightBox.querySelector(".td-pause-play-btn");o&&(o.textContent="▶️")}this.config.callbacks.onVideoControl&&this.config.callbacks.onVideoControl("playpause",n?n.currentTime:0)}},{key:"destroy",value:function(){this.log("Destroying QuadTap"),this.state.autoCancelTimer&&clearTimeout(this.state.autoCancelTimer),this.elements.container&&this.elements.container.removeEventListener("click",this.handleContainerClick),this.elements.profileBubble&&this.elements.profileBubble.removeEventListener("click",this.handleBubbleClick),this.elements.lightBox&&this.elements.lightBox.removeEventListener("click",this.handleLightBoxClick),this.elements.video&&(this.elements.video.removeEventListener("play",this.handleVideoPlay),this.elements.video.removeEventListener("pause",this.handleVideoPause)),window.removeEventListener("resize",this.throttledResize),document.removeEventListener("keydown",this.handleKeyDown),this.elements.overlay&&this.elements.overlay.parentNode&&this.elements.overlay.parentNode.removeChild(this.elements.overlay),this.elements.lightBox&&this.elements.lightBox.parentNode&&this.elements.lightBox.parentNode.removeChild(this.elements.lightBox),this.state.recording&&this.state.mediaRecorder&&this.stopRecording(),this.state.mediaStream&&this.state.mediaStream.getTracks().forEach((function(e){return e.stop()})),this.state={active:!1,profileBubblePosition:{x:0,y:0},currentQuadrant:null,autoCancelTimer:null,containerDimensions:{width:0,height:0},videoPlaying:!1,recording:!1,mediaStream:null,mediaRecorder:null,recordingStartTime:0,recordingIndicator:null},this.log("QuadTap destroyed")}}],t&&y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();return o.default.SettingsBuilder.VideoPlayerAdapter.Coordinates})(),"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("QuadTap",[],e):"object"==typeof exports?exports.QuadTap=e():this.QuadTap=e();
//# sourceMappingURL=quad-tap.js.map