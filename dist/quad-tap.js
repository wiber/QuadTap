!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("QuadTap",[],e):"object"==typeof exports?exports.QuadTap=e():t.QuadTap=e()}(this,(()=>(()=>{var t={642:(t,e,i)=>{var n,o,a,r;function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}t=i.nmd(t),r=function(){return function(){var t={d:function(e,i){for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}};function e(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(t);if(e.className&&(i.className=e.className),e.id&&(i.id=e.id),e.text&&(i.textContent=e.text),e.html&&(i.innerHTML=e.html),e.attributes)for(var n in e.attributes)i.setAttribute(n,e.attributes[n]);if(e.styles)for(var o in e.styles)i.style[o]=e.styles[o];if(e.events)for(var a in e.events)i.addEventListener(a,e.events[a]);return e.children&&e.children.forEach((function(t){i.appendChild(t)})),i}function i(t,e,i){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){var n=t.parentElement;if(n){var o=n.getBoundingClientRect();e=o.width*e,i=o.height*i}}t.style.left=e+"px",t.style.top=i+"px",t.style.transform="translate(-50%, -50%)"}function n(t){return n="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(t){return s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":s(t)},n(t)}t.d({},{default:function(){return D}});var o="quadTap_";function a(t,e){try{var i=o+t;return"object"===n(e)?localStorage.setItem(i,JSON.stringify(e)):localStorage.setItem(i,e),!0}catch(t){return console.error("[QuadTap] Error saving to localStorage:",t),!1}}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var i=o+t,n=localStorage.getItem(i);if(null===n)return e;try{return JSON.parse(n)}catch(t){return n}}catch(t){return console.error("[QuadTap] Error retrieving from localStorage:",t),e}}function l(t){return l="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(t){return s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":s(t)},l(t)}function d(){d=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",r=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,i,n){return Object.defineProperty(t,e,{value:i,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function u(e,i,n,o){var a=i&&i.prototype instanceof g?i:g,r=Object.create(a.prototype);return c(r,"_invoke",function(e,i,n){var o=1;return function(a,r){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw r;return{value:t,done:!0}}for(n.method=a,n.arg=r;;){var s=n.delegate;if(s){var l=S(s);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var d=h(e,i,n);if("normal"===d.type){if(o=n.done?4:2,d.arg===p)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(o=4,n.method="throw",n.arg=d.arg)}}}(e,n,new T(o||[])),!0),r}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p={};function g(){}function m(){}function f(){}var b={};c(b,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(B([])));y&&y!==i&&n.call(y,a)&&(b=y);var w=f.prototype=g.prototype=Object.create(b);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e,i){var n=document.createElement("button");w(n,b);var o=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),a=window.innerWidth<768;return(o||a)&&(n.style.width="26px",n.style.height="26px",n.style.margin="0 2px",n.style.fontSize="13px"),n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.lineHeight="1",n.style.padding="0",n.style.verticalAlign="middle",n.textContent=t,n.setAttribute("aria-label",e),n.addEventListener("mouseenter",(function(){w(n,v)})),n.addEventListener("mouseleave",(function(){n.style.backgroundColor=""})),n.addEventListener("click",(function(t){t.preventDefault(),i(t)})),n.addEventListener("touchstart",(function(t){t.preventDefault(),w(n,v)})),n.addEventListener("touchend",(function(t){t.preventDefault(),n.style.backgroundColor="",i(t)})),n.addEventListener("touchcancel",(function(t){n.style.backgroundColor=""})),n}function S(t){var n=i.method,o=e.i[n];if(o===t)return i.delegate=null,"throw"===n&&e.i.return&&(i.method="return",i.arg=t,S(e),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=h(o,e.i,i.arg);if("throw"===a.type)return i.method="throw",i.arg=a.arg,i.delegate=null,p;var r=a.arg;return r?r.done?(i[e.r]=r.value,i.next=e.n,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,p):r:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,p)}function j(t){this.tryEntries.push(t)}function k(e){var i=e[4]||{};i.type="normal",i.arg=t,e[4]=i}function T(t){this.tryEntries=[[-1]],t.forEach(j,this),this.reset(!0)}function B(e){if(null!=e){var i=e[a];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function i(){for(;++o<e.length;)if(n.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return r.next=r}}throw new TypeError(l(e)+" is not iterable")}return m.prototype=f,c(w,"constructor",f),c(f,"constructor",m),m.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(C.prototype),c(C.prototype,r,(function(){return this})),e.AsyncIterator=C,e.async=function(t,i,n,o,a){void 0===a&&(a=Promise);var r=new C(u(t,i,n,o),a);return e.isGeneratorFunction(i)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},x(w),c(w,s,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.unshift(n);return function t(){for(;i.length;)if((n=i.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=B,T.prototype={constructor:T,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(t){r.type="throw",r.arg=e,i.next=t}for(var o=i.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],r=a[4],s=this.prev,l=a[1],d=a[2];if(-1===a[0])return n("end"),!1;if(!l&&!d)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<l)return this.method="next",this.arg=t,n(l),!0;if(s<d)return n(d),!1}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o[2],p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i[2]===t)return this.complete(i[4],i[3]),k(i),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i[0]===t){var n=i[4];if("throw"===n.type){var o=n.arg;k(i)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={i:B(e),r:i,n},"next"===this.method&&(this.arg=t),p}},e}function c(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function u(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){c(a,n,o,r,s,"next",t)}function s(t){c(a,n,o,r,s,"throw",t)}r(void 0)}))}}function h(){return(h=u(d().mark((function t(e){var i,n,o;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.elements.video,!(o=(null===(i=e.config.videoPlayerApi)||void 0===i?void 0:i.enabled)&&e.config.videoPlayerApi.adapter)){t.next=7;break}return t.next=5,o.play();case 5:t.next=16;break;case 7:if(!n){t.next=16;break}return t.prev=8,t.next=11,n.play();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(8),console.error("Error resuming video playback:",t.t0);case 16:case"end":return t.stop()}}),t,null,[[8,13]])})))).apply(this,arguments)}function p(){return(p=u(d().mark((function t(e){var i,n,o;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.elements.video,!(o=(null===(i=e.config.videoPlayerApi)||void 0===i?void 0:i.enabled)&&e.config.videoPlayerApi.adapter)){t.next=11;break}return t.next=5,o.pause();case 5:t.next=12;break;case 11:n&&n.pause();case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var g={width:"60%",maxWidth:"350px",height:"auto",padding:"6px 10px",borderRadius:"24px",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"space-around",alignItems:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",transition:"opacity 0.3s ease, width 0.3s ease, padding 0.3s ease"},m={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},f={position:"static",top:"",left:"",transform:"",margin:"20px auto"},b={width:"30px",height:"30px",margin:"0 3px",borderRadius:"50%",border:"none",backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontSize:"14px",cursor:"pointer",outline:"none",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease"},v={backgroundColor:"rgba(255, 255, 255, 0.2)"},y={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"5px 10px",borderRadius:"4px",fontSize:"14px",zIndex:"2000",pointerEvents:"none",opacity:"0",transition:"opacity 0.3s ease"};function w(t,e){Object.assign(t.style,e)}function x(t){var e=t.overlay,i=t.onPlay,n=t.onPause,o=t.onRewind,a=t.onForward,r=t.onShare,s=t.onCopyUrl,l=t.rewindTime,d=void 0===l?30:l,c=t.forwardTime,u=void 0===c?30:c,h=t.debug,p=void 0!==h&&h,b=t.showAllButtons,v=void 0!==b&&b,y=t.isLightbox,x=void 0!==y&&y,S=document.createElement("div");w(S,g),w(S,x?f:m);var T=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),B=window.innerWidth<768;if((T||B)&&(S.style.width="65%",S.style.maxWidth="280px",S.style.padding="5px 8px"),!x){var E=parseInt(getComputedStyle(e).zIndex)||1e3;S.style.zIndex=(E+10).toString()}var q=C("⟲"+d,"Rewind "+d+" seconds",o),P=C("▶","Play/Pause",(function(t){var e="▶"===P.textContent;P.textContent=e?"❚❚":"▶",e?i(t):n(t)})),O=C("⟳"+u,"Forward "+u+" seconds",a),L=C("⤴","Share",(function(t){if(t.stopPropagation(),r)r(t);else{var e=window.location.href;navigator.share?navigator.share({title:"Check out this video moment",url:e}).catch((function(t){console.error("Error sharing:",t)})):(j(e),k(L,"Link copied!"))}})),I=C("⧉","Copy URL",(function(t){t.stopPropagation(),s?s(t):(j(window.location.href),k(I,"Link copied!"))}));if(S.appendChild(q),S.appendChild(P),S.appendChild(O),(v||x)&&(S.appendChild(L),S.appendChild(I)),S.addEventListener("click",(function(t){t.stopPropagation(),p&&console.log("[QuadTap] Control strip clicked, propagation stopped")})),S.addEventListener("touchstart",(function(t){t.stopPropagation(),S.style.opacity="1",p&&console.log("[QuadTap] Control strip touch started, propagation stopped")})),S.addEventListener("touchend",(function(t){t.stopPropagation(),p&&console.log("[QuadTap] Control strip touch ended, propagation stopped")})),S.addEventListener("touchmove",(function(t){t.stopPropagation()})),e.appendChild(S),!x){var z,A=function(){S.style.opacity="0.5"};S.addEventListener("mouseenter",(function(){clearTimeout(z),S.style.opacity="1"})),S.addEventListener("mouseleave",(function(){clearTimeout(z),z=setTimeout(A,2e3)})),S.style.opacity="1",z=setTimeout(A,2e3)}return p&&(console.log("[QuadTap] Control strip created with positioning:",{isLightbox:x,className:S.className,zIndex:S.style.zIndex}),x||new ResizeObserver((function(){var t=S.getBoundingClientRect(),i=e.getBoundingClientRect(),n=(t.top-i.top+t.height/2)/i.height*100,o=(t.left-i.left+t.width/2)/i.width*100;console.log("[QuadTap] Control strip position after resize:",{topPercent:n.toFixed(2)+"%",leftPercent:o.toFixed(2)+"%",width:t.width,height:t.height})})).observe(e)),S}function C(t,e,i){var n=document.createElement("button");w(n,b);var o=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),a=window.innerWidth<768;return(o||a)&&(n.style.width="26px",n.style.height="26px",n.style.margin="0 2px",n.style.fontSize="13px"),n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.lineHeight="1",n.style.padding="0",n.style.verticalAlign="middle",n.textContent=t,n.setAttribute("aria-label",e),n.addEventListener("mouseenter",(function(){w(n,v)})),n.addEventListener("mouseleave",(function(){n.style.backgroundColor=""})),n.addEventListener("click",(function(t){t.preventDefault(),i(t)})),n.addEventListener("touchstart",(function(t){t.preventDefault(),w(n,v)})),n.addEventListener("touchend",(function(t){t.preventDefault(),n.style.backgroundColor="",i(t)})),n.addEventListener("touchcancel",(function(t){n.style.backgroundColor=""})),n}function S(t,e){var i=t.querySelector("button:nth-child(2)");i&&(i.textContent=e?"❚❚":"▶")}function j(t){if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(t).catch((function(t){console.error("Failed to copy text: ",t)}));else{var e=document.createElement("textarea");e.value=t,e.style.position="fixed",document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.error("Failed to copy text: ",t)}document.body.removeChild(e)}}function k(t,e){var i=document.createElement("div");w(i,y),i.textContent=e;var n=t.getBoundingClientRect();i.style.top="".concat(n.top-30,"px"),i.style.left="".concat(n.left+n.width/2,"px"),i.style.transform="translateX(-50%)",document.body.appendChild(i),setTimeout((function(){i.style.opacity="1"}),10),setTimeout((function(){i.style.opacity="0",setTimeout((function(){document.body.removeChild(i)}),300)}),1500)}function T(t){return T="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(t){return s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":s(t)},T(t)}function B(t){var e=function(t){if("object"!=T(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=T(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(e)?e:e+""}var E={containerId:"main-video-droppable",videoSelector:"#main-video",autoCancelTimeout:5e3,debug:!0,emojis:{quadrants:{topLeft:"🕊️",topRight:"🌟",bottomLeft:"🌧️",bottomRight:"💥"},directional:{up:"🚀",right:"👑",down:"⬇️",left:"🤫"},thoughts:{topLeft:["🌸","🎈","🌦️","🛤️"],topRight:["🌈","✨","🌤️","🎆"],bottomLeft:["🍂","🌙","☔","🗿"],bottomRight:["⚖️","🏆","⛈️","💣"]}},videoControls:{enabled:!0,rewindTime:30,forwardTime:30},callbacks:{onOverlayActivate:null,onThrowDownInitiate:null,onThrowDownConfirm:null,onThrowDownCancel:null,onVideoControl:null}},q=function(){return t=function t(){var e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=Object.assign({},E,n),n.emojis&&(this.config.emojis=Object.assign({},E.emojis,n.emojis),n.emojis.quadrants&&(this.config.emojis.quadrants=Object.assign({},E.emojis.quadrants,n.emojis.quadrants)),n.emojis.directional&&(this.config.emojis.directional=Object.assign({},E.emojis.directional,n.emojis.directional)),n.emojis.thoughts&&(this.config.emojis.thoughts=Object.assign({},E.emojis.thoughts,n.emojis.thoughts))),n.videoControls&&(this.config.videoControls=Object.assign({},E.videoControls,n.videoControls)),n.profileBubble?this.config.profileBubble=Object.assign({},{imageUrl:null,fallbackEmoji:"👤",size:"60px",borderColor:"white",borderWidth:"2px",backgroundColor:"rgba(0, 0, 0, 0.7)"},n.profileBubble):this.config.profileBubble={imageUrl:null,fallbackEmoji:"👤",size:"60px",borderColor:"white",borderWidth:"2px",backgroundColor:"rgba(0, 0, 0, 0.7)"},n.colors?(this.config.colors={overlay:{background:"rgba(240, 240, 245, 0.5)",quadrantGradients:{topLeft:"rgba(0, 255, 255, 0.8)",topRight:"rgba(255, 255, 0, 0.8)",bottomLeft:"rgba(0, 255, 0, 0.8)",bottomRight:"rgba(255, 0, 255, 0.8)"}},lightbox:{background:"rgba(20, 30, 40, 0.95)",text:"white",headerBackground:"rgba(30, 40, 60, 0.8)",buttonPrimary:"#4CAF50",buttonSecondary:"#f44336"}},n.colors.overlay&&(this.config.colors.overlay=Object.assign({},this.config.colors.overlay,n.colors.overlay),n.colors.overlay.quadrantGradients&&(this.config.colors.overlay.quadrantGradients=Object.assign({},this.config.colors.overlay.quadrantGradients,n.colors.overlay.quadrantGradients))),n.colors.lightbox&&(this.config.colors.lightbox=Object.assign({},this.config.colors.lightbox,n.colors.lightbox))):this.config.colors={overlay:{background:"rgba(240, 240, 245, 0.5)",quadrantGradients:{topLeft:"rgba(0, 255, 255, 0.8)",topRight:"rgba(255, 255, 0, 0.8)",bottomLeft:"rgba(0, 255, 0, 0.8)",bottomRight:"rgba(255, 0, 255, 0.8)"}},lightbox:{background:"rgba(20, 30, 40, 0.95)",text:"white",headerBackground:"rgba(30, 40, 60, 0.8)",buttonPrimary:"#4CAF50",buttonSecondary:"#f44336"}},this.state={active:!1,profileBubblePosition:{x:0,y:0},currentQuadrant:null,autoCancelTimer:null,containerDimensions:{width:0,height:0},videoPlaying:!1,wasPlayingBefore:!1,recording:!1,mediaStream:null,mediaRecorder:null,recordingStartTime:0,recordingIndicator:null,swipeDebounceTimer:null,swipeProcessing:!1},this.elements={container:null,video:null,overlay:null,profileBubble:null,directionalEmojis:{},quadrantEmojis:{},videoControls:null,tooltip:null,lightBox:null,lightBoxContent:null,emojiGrid:null,commentBox:null},this.throttledResize=(e=this.handleResize.bind(this),function(){i||(e.apply(void 0,arguments),i=!0,setTimeout((function(){i=!1}),100))}),this.init()},n=[{key:"log",value:function(t,e){this.config.debug&&console.log("[QuadTap] ".concat(t),e||"")}},{key:"init",value:function(){this.log("Initializing QuadTap");var t=document.getElementById(this.config.containerId);t?(this.elements.container=t,function(){if(!document.getElementById("quad-tap-styles")){var t=document.createElement("style");t.id="quad-tap-styles",t.textContent="\n    /* Overlay Container */\n    .overlay-container {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      opacity: 0;\n      pointer-events: none;\n      transition: opacity 0.3s ease;\n      z-index: 1000;\n      background-color: rgba(240, 240, 245, 0.5);\n    }\n    \n    .overlay-container.active {\n      opacity: 1;\n      pointer-events: auto;\n    }\n    \n    /* Block pointer events on video when overlay is active */\n    .overlay-container.active + video,\n    .quad-tap-overlay.active + video {\n      pointer-events: none;\n    }\n    \n    /* Quadrants */\n    .quadrant {\n      position: absolute;\n      width: 50%;\n      height: 50%;\n      opacity: 0.8;\n      transition: opacity 0.3s ease;\n    }\n    \n    .quadrant.top-left {\n      top: 0;\n      left: 0;\n      background: linear-gradient(135deg, rgba(0, 255, 255, 0.8), rgba(0, 255, 255, 0));\n    }\n    \n    .quadrant.top-right {\n      top: 0;\n      right: 0;\n      background: linear-gradient(225deg, rgba(255, 255, 0, 0.8), rgba(255, 255, 0, 0));\n    }\n    \n    .quadrant.bottom-left {\n      bottom: 0;\n      left: 0;\n      background: linear-gradient(45deg, rgba(0, 255, 0, 0.8), rgba(0, 255, 0, 0));\n    }\n    \n    .quadrant.bottom-right {\n      bottom: 0;\n      right: 0;\n      background: linear-gradient(315deg, rgba(255, 0, 255, 0.8), rgba(255, 0, 255, 0));\n    }\n    \n    /* Profile Bubble */\n    .profile-bubble {\n      position: absolute;\n      width: 60px;\n      height: 60px;\n      border-radius: 50%;\n      background-color: rgba(128, 128, 128, 0.8);\n      border: 2px solid white;\n      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      cursor: pointer;\n      z-index: 1001;\n      transform: translate(-50%, -50%);\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n    }\n    \n    .profile-bubble:hover {\n      transform: translate(-50%, -50%) scale(1.1);\n      box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);\n    }\n    \n    /* Light-Box Modal */\n    .td-modal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(0, 0, 0, 0.7);\n      z-index: 2000;\n      justify-content: center;\n      align-items: center;\n      opacity: 0;\n      transition: opacity 0.3s ease;\n    }\n    \n    .td-modal.active {\n      display: flex;\n      opacity: 1;\n    }\n    \n    .td-modal-content {\n      background-color: white;\n      padding: 20px;\n      border-radius: 10px;\n      width: 95%;\n      max-width: 800px;\n      max-height: 80vh;\n      overflow-y: auto;\n      position: relative;\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);\n    }\n    \n    .td-modal-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 20px;\n      padding-bottom: 10px;\n      border-bottom: 1px solid #eee;\n    }\n    \n    .td-modal-header h4 {\n      margin: 0;\n      font-size: 1.5rem;\n      color: #333;\n    }\n    \n    .td-close-btn, .td-pause-play-btn {\n      background: none;\n      border: none;\n      font-size: 1.5rem;\n      cursor: pointer;\n      color: #999;\n      transition: color 0.2s ease;\n    }\n    \n    .td-close-btn {\n      margin-left: 10px;\n    }\n    \n    .td-pause-play-btn {\n      margin-left: auto;\n    }\n    \n    .td-close-btn:hover, .td-pause-play-btn:hover {\n      color: #333;\n    }\n    \n    /* Emoji Grid */\n    .emoji-grid {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      grid-template-rows: 1fr 1fr;\n      gap: 10px;\n      width: 100%;\n    }\n    \n    .emoji-quadrant {\n      padding: 10px;\n      border-radius: 8px;\n    }\n    \n    .emoji-quadrant.top-left {\n      background-color: rgba(0, 255, 255, 0.2);\n    }\n    \n    .emoji-quadrant.top-right {\n      background-color: rgba(255, 255, 0, 0.2);\n    }\n    \n    .emoji-quadrant.bottom-left {\n      background-color: rgba(0, 255, 0, 0.2);\n    }\n    \n    .emoji-quadrant.bottom-right {\n      background-color: rgba(255, 0, 255, 0.2);\n    }\n    \n    .emoji-row {\n      display: flex;\n      justify-content: space-around;\n      margin-bottom: 10px;\n      background-color: transparent;\n    }\n    \n    .emoji-cell {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background-color: transparent;\n    }\n    \n    .thought-emoji {\n      font-size: 2rem;\n      cursor: pointer;\n      padding: 5px;\n      border-radius: 5px;\n      transition: transform 0.2s ease, background-color 0.2s ease;\n    }\n    \n    .thought-emoji:hover {\n      transform: scale(1.2);\n      background-color: rgba(255, 255, 255, 0.5);\n    }\n    \n    .thought-emoji.selected {\n      background-color: rgba(255, 255, 255, 0.8);\n      box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);\n    }\n    \n    /* Tooltip */\n    .tooltip {\n      position: absolute;\n      background-color: rgba(0, 0, 0, 0.7);\n      color: white;\n      padding: 5px 10px;\n      border-radius: 5px;\n      font-size: 0.8rem;\n      pointer-events: none;\n      z-index: 1002;\n      transition: opacity 0.3s ease;\n    }\n    \n    /* Comment Box */\n    .comment-box {\n      margin-top: 20px;\n      width: 100%;\n    }\n    \n    .comment-box textarea {\n      width: 100%;\n      padding: 10px;\n      border: 1px solid #ddd;\n      border-radius: 5px;\n      resize: vertical;\n      min-height: 80px;\n      font-family: inherit;\n    }\n    \n    /* Media Buttons */\n    .media-buttons {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 10px;\n      margin-top: 10px;\n      margin-bottom: 10px;\n    }\n    \n    .media-button {\n      padding: 8px 12px;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-weight: bold;\n      transition: background-color 0.2s ease;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    \n    .upload-button {\n      background-color: #3498db;\n      color: white;\n    }\n    \n    .upload-button:hover {\n      background-color: #2980b9;\n    }\n    \n    .capture-button {\n      background-color: #e74c3c;\n      color: white;\n    }\n    \n    .capture-button:hover {\n      background-color: #c0392b;\n    }\n    \n    .uploaded-file-name {\n      margin-top: 5px;\n      padding: 5px;\n      background-color: #f1f1f1;\n      border-radius: 3px;\n      font-size: 0.9rem;\n      width: 100%;\n    }\n    \n    .recording-message {\n      margin-top: 5px;\n      padding: 5px;\n      background-color: #f8d7da;\n      color: #721c24;\n      border-radius: 3px;\n      font-size: 0.9rem;\n      width: 100%;\n    }\n    \n    .recording-indicator {\n      animation: pulse 1.5s infinite;\n    }\n    \n    @keyframes pulse {\n      0% { opacity: 1; }\n      50% { opacity: 0.5; }\n      100% { opacity: 1; }\n    }\n    \n    /* Action Buttons */\n    .action-buttons {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 20px;\n      gap: 10px;\n    }\n    \n    .action-button {\n      padding: 8px 16px;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-weight: bold;\n      transition: background-color 0.2s ease;\n    }\n    \n    .save-button {\n      background-color: #4CAF50;\n      color: white;\n    }\n    \n    .save-button:hover {\n      background-color: #45a049;\n    }\n    \n    .cancel-button {\n      background-color: #f44336;\n      color: white;\n    }\n    \n    .cancel-button:hover {\n      background-color: #d32f2f;\n    }\n  ",document.head.appendChild(t)}}(),this.createOverlayElements(),this.createLightBoxElements(),this.bindEventHandlers(),this.log("QuadTap initialized successfully")):this.log("Container not found",this.config.containerId)}},{key:"createOverlayElements",value:function(){var t=this,i=e("div",{className:"quad-tap-overlay",styles:{display:"none",backgroundColor:this.config.colors.overlay.background}}),n=e("div",{className:"overlay-close-btn",html:"&times;",styles:{position:"absolute",top:"10px",right:"10px",width:"30px",height:"30px",borderRadius:"50%",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"20px",cursor:"pointer",zIndex:"1002"},events:{click:function(e){t.deactivateOverlay(),e.stopPropagation()}}}),o=e("div",{className:"quadrant top-left",styles:{background:"radial-gradient(circle at 0% 0%, ".concat(this.config.colors.overlay.quadrantGradients.topLeft,", transparent 70%)")}}),a=e("div",{className:"quadrant top-right",styles:{background:"radial-gradient(circle at 100% 0%, ".concat(this.config.colors.overlay.quadrantGradients.topRight,", transparent 70%)")}}),r=e("div",{className:"quadrant bottom-left",styles:{background:"radial-gradient(circle at 0% 100%, ".concat(this.config.colors.overlay.quadrantGradients.bottomLeft,", transparent 70%)")}}),s=e("div",{className:"quadrant bottom-right",styles:{background:"radial-gradient(circle at 100% 100%, ".concat(this.config.colors.overlay.quadrantGradients.bottomRight,", transparent 70%)")}}),l={display:"none",width:this.config.profileBubble.size,height:this.config.profileBubble.size,borderColor:this.config.profileBubble.borderColor,borderWidth:this.config.profileBubble.borderWidth,backgroundColor:this.config.profileBubble.backgroundColor,borderStyle:"solid",borderRadius:"50%",justifyContent:"center",alignItems:"center",fontSize:"24px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.5)",cursor:"pointer",zIndex:"1000"};this.config.profileBubble.imageUrl&&(l.backgroundImage="url(".concat(this.config.profileBubble.imageUrl,")"),l.backgroundSize="cover",l.backgroundPosition="center",l.fontSize="0");var d=e("div",{className:"profile-bubble",text:this.config.profileBubble.imageUrl?"":this.config.profileBubble.fallbackEmoji,styles:l}),c=e("div",{className:"directional-emoji up",text:this.config.emojis.directional.up,styles:{display:"none"}}),u=e("div",{className:"directional-emoji right",text:this.config.emojis.directional.right,styles:{display:"none"}}),h=e("div",{className:"directional-emoji down",text:this.config.emojis.directional.down,styles:{display:"none"}}),p=e("div",{className:"directional-emoji left",text:this.config.emojis.directional.left,styles:{display:"none"}}),g=e("div",{className:"quadrant-emoji top-left",text:this.config.emojis.quadrants.topLeft,styles:{display:"none"}}),m=e("div",{className:"quadrant-emoji top-right",text:this.config.emojis.quadrants.topRight,styles:{display:"none"}}),f=e("div",{className:"quadrant-emoji bottom-left",text:this.config.emojis.quadrants.bottomLeft,styles:{display:"none"}}),b=e("div",{className:"quadrant-emoji bottom-right",text:this.config.emojis.quadrants.bottomRight,styles:{display:"none"}}),v=this.createVideoControls(),y=e("div",{className:"tooltip",text:"Tap elsewhere to cancel",styles:{display:"none"}});i.appendChild(n),i.appendChild(o),i.appendChild(a),i.appendChild(r),i.appendChild(s),i.appendChild(c),i.appendChild(u),i.appendChild(h),i.appendChild(p),i.appendChild(g),i.appendChild(m),i.appendChild(f),i.appendChild(b),i.appendChild(d),i.appendChild(v),i.appendChild(y),this.elements.container.appendChild(i),this.elements.overlay=i,this.elements.profileBubble=d,this.elements.directionalEmojis={up:c,right:u,down:h,left:p},this.elements.quadrantEmojis={topLeft:g,topRight:m,bottomLeft:f,bottomRight:b},this.elements.videoControls=v,this.elements.tooltip=y}},{key:"createVideoControls",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.config.videoControls.enabled)return e("div",{styles:{display:"none"}});var n=document.querySelector(this.config.videoSelector),o=x({overlay:i?this.elements.lightBoxContent||document.createElement("div"):this.elements.overlay||document.createElement("div"),onPlay:function(){n&&n.play()},onPause:function(){n&&n.pause()},onRewind:function(){n&&(n.currentTime=Math.max(0,n.currentTime-t.config.videoControls.rewindTime))},onForward:function(){n&&(n.currentTime=Math.min(n.duration,n.currentTime+t.config.videoControls.forwardTime))},rewindTime:this.config.videoControls.rewindTime,forwardTime:this.config.videoControls.forwardTime,debug:this.config.debug,showAllButtons:!0,isLightbox:i});return i||(o.style.display="none"),this.elements.videoControlsObj={element:o,setMode:function(e,i){!function(t,e,i){if(t.classList.remove("qt-control-strip--overlay"),t.classList.remove("qt-control-strip--lightbox"),"overlay"===e){t.classList.add("qt-control-strip--overlay"),t.style.position="absolute",t.style.bottom="20px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.zIndex="1000";var n=i.offsetWidth;t.style.width="".concat(Math.min(.8*n,400),"px"),t.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.3)"}else"lightbox"===e&&(t.classList.add("qt-control-strip--lightbox"),t.style.position="static",t.style.bottom="",t.style.left="",t.style.transform="",t.style.zIndex="",t.style.width="100%",t.style.boxShadow="none")}(o,"lightbox"===e,i||t.elements.container)},updateTimeDisplay:function(){},updatePlayPauseButton:function(t){S(o,t)}},o}},{key:"createLightboxControlStrip",value:function(){var t=this;if(!this.config.videoControls.enabled)return e("div",{styles:{display:"none"}});var i=e("div",{className:"td-lightbox-controls",styles:{width:"100%",padding:"10px 0",marginTop:"10px",marginBottom:"10px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"column"}}),n=document.querySelector(this.config.videoSelector),o=x({overlay:this.elements.lightBoxContent||document.createElement("div"),onPlay:function(){n&&n.play()},onPause:function(){n&&n.pause()},onRewind:function(){n&&(n.currentTime=Math.max(0,n.currentTime-t.config.videoControls.rewindTime))},onForward:function(){n&&(n.currentTime=Math.min(n.duration,n.currentTime+t.config.videoControls.forwardTime))},rewindTime:this.config.videoControls.rewindTime,forwardTime:this.config.videoControls.forwardTime,debug:this.config.debug,showAllButtons:!0,isLightbox:!0});return this.elements.lightboxControlStripObj={element:o,updateTimeDisplay:function(){},updatePlayPauseButton:function(t){S(o,t)}},this.elements.lightboxControlStrip=o,i.appendChild(o),i}},{key:"createLightBoxElements",value:function(){var t=this,i=e("div",{id:"throwdown-modal",className:"td-modal"}),n=e("div",{className:"td-modal-content",styles:{backgroundColor:this.config.colors.lightbox.background,color:this.config.colors.lightbox.text}}),o=e("div",{className:"td-modal-header",styles:{backgroundColor:this.config.colors.lightbox.headerBackground}}),r=e("h4",{text:"Share Your Thoughts"}),s=e("button",{className:"td-close-btn",html:"&times;",events:{click:function(e){t.closeLightBox(),e.stopPropagation()}}}),l=e("div",{className:"td-video-info",styles:{fontSize:"14px",color:"#888",marginRight:"10px"}});o.appendChild(r),o.appendChild(l),o.appendChild(s);var d=this.createEmojiGrid(),c=e("div",{className:"comment-box"}),u=e("textarea",{placeholder:"Add a comment (optional)",attributes:{rows:3,maxlength:500},events:{input:function(e){var i=e.target.value,n=t.extractUrlFromText(i);n&&a("extractedUrl",n),a("comment",i),t.saveEventToHistory({type:"comment_update",comment:i,extractedUrl:n})}}});c.appendChild(u);var h=e("div",{className:"media-buttons"}),p=e("button",{className:"media-button upload-button",text:"📤 Upload Video",events:{click:function(i){var n=e("input",{attributes:{type:"file",accept:"video/*"},events:{change:function(e){var i=e.target.files[0];if(i){t.log("Video file selected",i.name),a("uploadedVideo",i.name);var n=document.createElement("div");n.className="uploaded-file-name",n.textContent="Selected: ".concat(i.name),h.appendChild(n),t.saveEventToHistory({type:"video_upload",fileName:i.name,fileSize:i.size,fileType:i.type})}}}});document.body.appendChild(n),n.click(),document.body.removeChild(n),i.stopPropagation()}}}),g=e("button",{className:"media-button capture-button",text:"📹 Record Video",events:{click:function(e){if(t.state.recording){t.stopRecording(),g.textContent="📹 Record Video";var i=document.createElement("div");i.className="recording-message",i.textContent="Recording saved",h.appendChild(i),setTimeout((function(){i.parentNode&&i.parentNode.removeChild(i)}),3e3)}else t.startRecording(),g.textContent="⏹️ Stop Recording";e.stopPropagation()}}});h.appendChild(p),h.appendChild(g),c.appendChild(h);var m=e("div",{className:"action-buttons"}),f=e("button",{className:"action-button cancel-button",text:"Cancel",styles:{backgroundColor:this.config.colors.lightbox.buttonSecondary,color:"white"},events:{click:function(e){t.closeLightBox(),e.stopPropagation()}}}),b=e("button",{className:"action-button save-button",text:"Save",styles:{backgroundColor:this.config.colors.lightbox.buttonPrimary,color:"white"},events:{click:function(e){t.saveThrowDown(),e.stopPropagation()}}});m.appendChild(f),m.appendChild(b),n.appendChild(o),n.appendChild(d);var v=e("div",{styles:{width:"100%",height:"20px",clear:"both"}});n.appendChild(v);var y=this.createLightboxControlStrip();n.appendChild(y),n.appendChild(c),n.appendChild(m),i.appendChild(n),document.body.appendChild(i),this.elements.lightBox=i,this.elements.lightBoxContent=n,this.elements.videoInfoDisplay=l,this.elements.emojiGrid=d,this.elements.commentBox=c}},{key:"createEmojiGrid",value:function(){var t=e("div",{className:"emoji-grid",styles:{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"1fr 1fr",gap:"10px",width:"100%"}}),i=e("div",{className:"emoji-quadrant top-left",styles:{gridRow:"1",gridColumn:"1"}}),n=e("div",{className:"emoji-quadrant top-right",styles:{gridRow:"1",gridColumn:"2"}}),o=e("div",{className:"emoji-quadrant bottom-left",styles:{gridRow:"2",gridColumn:"1"}}),a=e("div",{className:"emoji-quadrant bottom-right",styles:{gridRow:"2",gridColumn:"2"}});return this.createEmojiTable(i,this.config.emojis.thoughts.topLeft,"top-left"),this.createEmojiTable(n,this.config.emojis.thoughts.topRight,"top-right"),this.createEmojiTable(o,this.config.emojis.thoughts.bottomLeft,"bottom-left"),this.createEmojiTable(a,this.config.emojis.thoughts.bottomRight,"bottom-right"),t.appendChild(i),t.appendChild(n),t.appendChild(o),t.appendChild(a),t}},{key:"createEmojiTable",value:function(t,i,n){var o=this,a=e("div",{className:"emoji-row"}),r=e("div",{className:"emoji-cell"});if(i[0]){var s=e("div",{className:"thought-emoji",text:i[0],attributes:{"data-emoji":i[0],"data-quadrant":n,"data-index":0},events:{click:function(t){o.selectEmoji(s,i[0],n,0)}}});r.appendChild(s)}var l=e("div",{className:"emoji-cell"});if(i[1]){var d=e("div",{className:"thought-emoji",text:i[1],attributes:{"data-emoji":i[1],"data-quadrant":n,"data-index":1},events:{click:function(t){o.selectEmoji(d,i[1],n,1)}}});l.appendChild(d)}a.appendChild(r),a.appendChild(l);var c=e("div",{className:"emoji-row"}),u=e("div",{className:"emoji-cell"});if(i[2]){var h=e("div",{className:"thought-emoji",text:i[2],attributes:{"data-emoji":i[2],"data-quadrant":n,"data-index":2},events:{click:function(t){o.selectEmoji(h,i[2],n,2)}}});u.appendChild(h)}var p=e("div",{className:"emoji-cell"});if(i[3]){var g=e("div",{className:"thought-emoji",text:i[3],attributes:{"data-emoji":i[3],"data-quadrant":n,"data-index":3},events:{click:function(t){o.selectEmoji(g,i[3],n,3)}}});p.appendChild(g)}c.appendChild(u),c.appendChild(p),t.appendChild(a),t.appendChild(c)}},{key:"extractUrlFromText",value:function(t){if(!t)return null;var e=t.match(/(https?:\/\/[^\s]+)/g);return e&&e.length>0?e[0]:null}},{key:"saveEventToHistory",value:function(t){t.timestamp=(new Date).toISOString(),t.context={profileBubblePosition:this.state.profileBubblePosition,currentQuadrant:this.state.currentQuadrant,containerDimensions:this.state.containerDimensions};var e=[];try{var i=localStorage.getItem("quadTapEvents");i&&(e=JSON.parse(i))}catch(t){this.log("Error parsing stored events",t)}e.push(t),localStorage.setItem("quadTapEvents",JSON.stringify(e)),localStorage.setItem("quadTapCurrentEvent",JSON.stringify(t)),this.log("Event saved to history",t)}},{key:"selectEmoji",value:function(t,e,i,n){this.log("Emoji selected",{emoji:e,quadrant:i,index:n}),this.elements.emojiGrid.querySelectorAll(".thought-emoji").forEach((function(t){return t.classList.remove("selected")})),t.classList.add("selected"),a("selectedEmoji",e),a("selectedQuadrant",i),a("selectedIndex",n),this.saveEventToHistory({type:"emoji_selected",emoji:e,quadrant:i,index:n});var o=document.querySelector(this.config.videoSelector);if(o&&(a("videoTime",o.currentTime),a("videoId",o.getAttribute("data-video-id")||"unknown")),a("positionX",this.state.profileBubblePosition.x),a("positionY",this.state.profileBubblePosition.y),this.config.callbacks.onThrowDownConfirm){var r=o?{currentTime:o.currentTime,videoId:o.getAttribute("data-video-id")||"unknown",duration:o.duration}:null;this.config.callbacks.onThrowDownConfirm(i,this.state.profileBubblePosition.x,this.state.profileBubblePosition.y,r)}}},{key:"saveThrowDown",value:function(){this.log("Saving throw-down");var t=this.elements.commentBox.querySelector("textarea"),e=t?t.value:"",i=this.extractUrlFromText(e);a("comment",e),i&&a("extractedUrl",i),a("timestamp",Date.now());var n=document.querySelector(this.config.videoSelector),o={};n&&(Array.from(n.attributes).filter((function(t){return t.name.startsWith("data-")})).forEach((function(t){var e=t.name.replace("data-","");o[e]=t.value})),o.duration=n.duration||0,o.currentTime=n.currentTime||0,o.paused=n.paused,o.muted=n.muted,o.volume=n.volume,o.playbackRate=n.playbackRate,o.videoWidth=n.videoWidth,o.videoHeight=n.videoHeight,o.src=n.currentSrc||n.src);var s={selectedEmoji:r("selectedEmoji",""),selectedQuadrant:r("selectedQuadrant",""),selectedIndex:r("selectedIndex",-1),comment:e,extractedUrl:i||r("extractedUrl",""),positionX:this.state.profileBubblePosition.x,positionY:this.state.profileBubblePosition.y,quadrant:this.state.currentQuadrant,videoId:r("videoId",n&&n.getAttribute("data-video-id")||"unknown"),videoTime:r("videoTime",n?n.currentTime:0),videoMetadata:o,containerId:this.config.containerId,containerWidth:this.state.containerDimensions.width,containerHeight:this.state.containerDimensions.height,timestamp:Date.now(),timezoneOffset:(new Date).getTimezoneOffset(),locale:navigator.language||"en-US",userAgent:navigator.userAgent,platform:navigator.platform,url:window.location.href,referrer:document.referrer,title:document.title};!function(t){try{for(var e in t)a(e,t[e]);return a("timestamp",Date.now()),!0}catch(t){return console.error("[QuadTap] Error saving throw-down context:",t),!1}}(s),this.closeLightBox(),this.log("Throw-down saved",s)}},{key:"bindEventHandlers",value:function(){var t=this;this.elements.video=document.querySelector(this.config.videoSelector),(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768)&&this.elements.video&&(this.elements.video.addEventListener("webkitbeginfullscreen",(function(t){return t.preventDefault&&t.preventDefault(),!1})),this.elements.video.setAttribute("playsinline",""),this.elements.video.setAttribute("webkit-playsinline",""),this.elements.video.removeAttribute("controls"),this.elements.video.controls=!1,setTimeout((function(){try{document.querySelectorAll(".vjs-fullscreen-control, .fullscreen-button, [data-fullscreen], .ytp-fullscreen-button").forEach((function(t){t.style&&(t.style.display="none"),t.addEventListener("click",(function(t){return t.preventDefault&&t.preventDefault(),t.stopPropagation(),!1}))}))}catch(e){t.log("Error disabling fullscreen buttons",e)}}),500));var e=function(e){if(e.preventDefault(),e.stopPropagation(),!e.target.closest(".video-control-button"))if(t.state.active)e.target===t.elements.profileBubble||t.elements.profileBubble.contains(e.target)?t.openLightBox():t.deactivateOverlay();else{var i,n,o=t.elements.container.getBoundingClientRect();if("touchstart"===e.type||"touchend"===e.type){var a=e.changedTouches[0];i=a.clientX-o.left,n=a.clientY-o.top}else i=e.clientX-o.left,n=e.clientY-o.top;t.activateOverlay(i,n)}};this.elements.container.addEventListener("click",e),this.elements.container.addEventListener("touchend",e);var i=function(e){t.state.active&&(t.openLightBox(),e.stopPropagation())};this.elements.profileBubble.addEventListener("click",i),this.elements.profileBubble.addEventListener("touchend",(function(t){t.preventDefault(),i(t)}));var n=function(e){e.target===t.elements.lightBox&&t.closeLightBox()};this.elements.lightBox.addEventListener("click",n),this.elements.lightBox.addEventListener("touchend",n),document.addEventListener("keydown",(function(e){"Escape"===e.key&&(t.elements.lightBox.classList.contains("active")?t.closeLightBox():t.state.active&&t.deactivateOverlay())})),this.elements.video&&(this.elements.video.addEventListener("play",(function(){t.state.videoPlaying=!0})),this.elements.video.addEventListener("pause",(function(){t.state.videoPlaying=!1}))),window.addEventListener("resize",this.throttledResize),this.updateContainerDimensions(),this.addSwipeHandlers()}},{key:"addSwipeHandlers",value:function(){var t=this;this.state.swipe={startX:0,startY:0,endX:0,endY:0,startTime:0,onVideo:!1,overlayActive:!1,threshold:50,maxTime:500};var e=function(e){var i,n,o;e.type.includes("touch")?(i=e.touches[0].clientX,n=e.touches[0].clientY,o=document.elementFromPoint(i,n)):(i=e.clientX,n=e.clientY,o=e.target),t.state.swipe.startX=i,t.state.swipe.startY=n,t.state.swipe.startTime=Date.now(),t.state.swipe.onVideo=o===t.elements.video,t.state.swipe.overlayActive=t.state.active,t.log("Swipe start",{x:i,y:n,onVideo:t.state.swipe.onVideo,overlayActive:t.state.swipe.overlayActive})},i=function(e){var i,n;if(t.state.swipeProcessing)t.log("Ignoring swipe end during active processing");else if(0!==t.state.swipe.startX||0!==t.state.swipe.startY){e.type.includes("touch")?(i=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):(i=e.clientX,n=e.clientY),t.state.swipe.endX=i,t.state.swipe.endY=n;var o=t.state.swipe.endX-t.state.swipe.startX,a=t.state.swipe.endY-t.state.swipe.startY,r=Date.now()-t.state.swipe.startTime;if(t.state.swipe.startX=0,t.state.swipe.startY=0,r<=t.state.swipe.maxTime){var s="",l=Math.abs(o),d=Math.abs(a);Math.max(l,d)>=t.state.swipe.threshold&&(s=l>d?o>0?"right":"left":a>0?"down":"up",t.log("Swipe detected",{direction:s,onVideo:t.state.swipe.onVideo,overlayActive:t.state.swipe.overlayActive,deltaX:o,deltaY:a,time:r}),t.handleSwipe(s))}}},n=function(t){t.cancelable&&t.preventDefault()};this.elements.container.addEventListener("mousedown",e),document.addEventListener("mouseup",i),document.addEventListener("mousemove",(function(t){1===t.buttons&&n(t)})),this.elements.container.addEventListener("touchstart",e,{passive:!1}),this.elements.container.addEventListener("touchend",i),this.elements.container.addEventListener("touchmove",n,{passive:!1})}},{key:"handleSwipe",value:function(t){var e=this;if(this.state.swipeProcessing)this.log("Ignoring swipe during active processing",t);else{this.state.swipeProcessing=!0,this.state.swipeDebounceTimer&&clearTimeout(this.state.swipeDebounceTimer);var i="Swipe: "+t.toUpperCase()+"\nOverlay: "+(this.state.swipe.overlayActive?"ACTIVE":"INACTIVE")+"\nOn Video: "+(this.state.swipe.onVideo?"YES":"NO");this.state.swipeInfo=i,this.elements.lightBox&&this.elements.lightBox.classList.contains("active")?this.updateLightboxSwipeInfo(i):this.openLightBoxWithSwipeInfo(i),this.state.swipeDebounceTimer=setTimeout((function(){e.state.swipeProcessing=!1,e.state.swipeDebounceTimer=null}),500)}}},{key:"updateLightboxSwipeInfo",value:function(t){if(this.elements.lightBoxContent){var e=this.elements.lightBoxContent.querySelector(".swipe-info");e||((e=document.createElement("div")).className="swipe-info",e.style.padding="10px",e.style.marginTop="15px",e.style.backgroundColor="rgba(0,0,0,0.1)",e.style.borderRadius="5px",e.style.fontFamily="monospace",e.style.whiteSpace="pre",this.elements.lightBoxContent.appendChild(e)),e.textContent=t}}},{key:"openLightBoxWithSwipeInfo",value:function(t){var e=this;this.openLightBox(),setTimeout((function(){e.updateLightboxSwipeInfo(t)}),100)}},{key:"handleResize",value:function(){if(this.state.active){this.updateContainerDimensions();var t=this.state.containerDimensions.width*this.state.profileBubblePosition.x,e=this.state.containerDimensions.height*this.state.profileBubblePosition.y;i(this.elements.profileBubble,t,e),this.positionDirectionalEmojis(t,e),this.positionQuadrantEmojis(),this.positionVideoControls(),this.positionTooltip()}if(this.elements.lightBox&&this.elements.lightBox.classList.contains("active")&&this.elements.lightBoxContent){var n=window.innerWidth,o=window.innerHeight,a=Math.min(.95*n,n<768?600:800),r=.85*o;this.elements.lightBoxContent.style.maxWidth=a+"px",this.elements.lightBoxContent.style.maxHeight=r+"px",n<768?(this.elements.lightBox.style.paddingTop="5vh",this.elements.lightBox.style.alignItems="flex-start"):(this.elements.lightBox.style.paddingTop="0",this.elements.lightBox.style.alignItems="center"),this.config.debug&&this.log("Window resized, updated lightbox dimensions",{viewport:{width:n,height:o},lightbox:{maxWidth:a,maxHeight:r}})}}},{key:"updateContainerDimensions",value:function(){if(this.elements.container){var t=this.elements.container.getBoundingClientRect();this.state.containerDimensions={width:t.width,height:t.height}}}},{key:"activateOverlay",value:function(t,e){var n=this;this.log("Activating overlay",{x:t,y:e});var o=t/this.state.containerDimensions.width,a=e/this.state.containerDimensions.height;this.state.profileBubblePosition={x:o,y:a},this.state.currentQuadrant=function(t,e,i){var n=i.getBoundingClientRect(),o=n.width/2,a=n.height/2;return t<o?e<a?"top-left":"bottom-left":e<a?"top-right":"bottom-right"}(t,e,this.elements.container),this.log("Current quadrant",this.state.currentQuadrant),this.elements.overlay.style.display="block",setTimeout((function(){n.elements.overlay.classList.add("active")}),10),this.elements.profileBubble.style.display="flex";var r=this.calculateResponsiveBubbleSize();this.elements.profileBubble.style.width=r.width,this.elements.profileBubble.style.height=r.height;var s=this.state.containerDimensions.width*this.state.profileBubblePosition.x,l=this.state.containerDimensions.height*this.state.profileBubblePosition.y;i(this.elements.profileBubble,s,l),this.positionDirectionalEmojis(t,e),this.positionQuadrantEmojis(),this.positionVideoControls(),this.positionTooltip(),this.state.active=!0,this.config.autoCancelTimeout>0&&(this.state.autoCancelTimer=setTimeout((function(){n.deactivateOverlay()}),this.config.autoCancelTimeout)),this.config.callbacks.onOverlayActivate&&this.config.callbacks.onOverlayActivate(t,e)}},{key:"positionDirectionalEmojis",value:function(t,e){var i=this.state.containerDimensions,n=i.width,o=i.height,a=e,r=n-t,s=o-e,l=t,d=n/2,c=.1*o,u=.9*n,h=o/2,p=n/2,g=.9*o,m=.1*n,f=o/2,b=Math.sqrt(Math.pow(t-d,2)+Math.pow(e-c,2)),v=Math.sqrt(Math.pow(t-u,2)+Math.pow(e-h,2)),y=Math.sqrt(Math.pow(t-p,2)+Math.pow(e-g,2)),w=Math.sqrt(Math.pow(t-m,2)+Math.pow(e-f,2)),x=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)),C=.8+Math.max(0,1.2*(1-b/x))+Math.max(0,.8*(1-a/(o/2))),S=.8+Math.max(0,1.2*(1-v/x))+Math.max(0,.8*(1-r/(n/2))),j=.8+Math.max(0,1.2*(1-y/x))+Math.max(0,.8*(1-s/(o/2))),k=.8+Math.max(0,1.2*(1-w/x))+Math.max(0,.8*(1-l/(n/2))),T=this.elements.directionalEmojis.up;T.style.display="block",T.style.position="absolute",T.style.top="10%",T.style.left="50%",T.style.transform="translate(-50%, 0) scale(".concat(C,")"),T.style.fontSize="2rem",T.style.opacity="0.8";var B=this.elements.directionalEmojis.right;B.style.display="block",B.style.position="absolute",B.style.top="50%",B.style.right="10%",B.style.transform="translate(0, -50%) scale(".concat(S,")"),B.style.fontSize="2rem",B.style.opacity="0.8";var E=this.elements.directionalEmojis.down;E.style.display="block",E.style.position="absolute",E.style.bottom="10%",E.style.left="50%",E.style.transform="translate(-50%, 0) scale(".concat(j,")"),E.style.fontSize="2rem",E.style.opacity="0.8";var q=this.elements.directionalEmojis.left;q.style.display="block",q.style.position="absolute",q.style.top="50%",q.style.left="10%",q.style.transform="translate(0, -50%) scale(".concat(k,")"),q.style.fontSize="2rem",q.style.opacity="0.8"}},{key:"calculateResponsiveEmojiSize",value:function(){var t,e,i,n=this.state.containerDimensions,o=n.width,a=n.height,r=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768,s=a>o;return i=o<200?.3:o<300?.4:o<400?.5:o<600?.6:o<800?.7:.8,s&&r&&(i*=.75),t=i+"rem",e=1.4*i+"rem",this.config.debug&&console.log("[QuadTap] Responsive emoji sizes:",{width:o,height:a,isPortrait:s,isMobile:r,defaultSize:t,enlargedSize:e}),{defaultSize:t,enlargedSize:e,defaultOpacity:"0.6",enlargedOpacity:"0.8"}}},{key:"calculateResponsiveBubbleSize",value:function(){var t,e=this.state.containerDimensions.width,i=this.state.containerDimensions.height,n=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768,o=i>e,a=n?.12:.1;return t=Math.round(e*a),t=Math.max(30,t),t=Math.min(70,t),o&&n&&(t=Math.floor(.9*t)),this.config.debug&&console.log("[QuadTap] Responsive bubble size:",{width:e,height:i,isPortrait:o,isMobile:n,bubbleSize:t}),{width:t+"px",height:t+"px"}}},{key:"positionQuadrantEmojis",value:function(){var t=this.calculateResponsiveEmojiSize(),e=t.defaultSize,i=t.enlargedSize,n=t.defaultOpacity,o=t.enlargedOpacity,a=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768?"3%":"4%",r=this.elements.quadrantEmojis.topLeft;r.style.display="block",r.style.position="absolute",r.style.top=a,r.style.left=a,r.style.transform="translate(-50%, -50%)",r.style.fontSize=e,r.style.opacity=n;var s=this.elements.quadrantEmojis.topRight;s.style.display="block",s.style.position="absolute",s.style.top=a,s.style.right=a,s.style.transform="translate(50%, -50%)",s.style.fontSize=e,s.style.opacity=n;var l=this.elements.quadrantEmojis.bottomLeft;l.style.display="block",l.style.position="absolute",l.style.bottom=a,l.style.left=a,l.style.transform="translate(-50%, 50%)",l.style.fontSize=e,l.style.opacity=n;var d=this.elements.quadrantEmojis.bottomRight;if(d.style.display="block",d.style.position="absolute",d.style.bottom=a,d.style.right=a,d.style.transform="translate(50%, 50%)",d.style.fontSize=e,d.style.opacity=n,this.state.currentQuadrant)switch(this.state.currentQuadrant){case"top-left":r.style.fontSize=i,r.style.opacity=o;break;case"top-right":s.style.fontSize=i,s.style.opacity=o;break;case"bottom-left":l.style.fontSize=i,l.style.opacity=o;break;case"bottom-right":d.style.fontSize=i,d.style.opacity=o}}},{key:"positionVideoControls",value:function(){if(this.config.videoControls.enabled){var t=this.elements.videoControls;t.style.display="flex",t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.zIndex="1001"}}},{key:"positionTooltip",value:function(){if(this.config.tooltip&&!1!==this.config.tooltip.enabled){var t=this.elements.tooltip;switch(t.style.display="block",t.style.position="absolute",t.style.zIndex="1001",this.config.tooltip.text&&(t.textContent=this.config.tooltip.text),this.config.tooltip.position||"above-controls"){case"above-controls":default:t.style.top="40%",t.style.left="50%",t.style.transform="translate(-50%, -50%)";break;case"below-controls":t.style.top="60%",t.style.left="50%",t.style.transform="translate(-50%, -50%)";break;case"on-bubble":var e=this.elements.profileBubble.getBoundingClientRect(),i=this.elements.overlay.getBoundingClientRect(),n=(e.top-i.top)/i.height*100;t.style.top="".concat(n-10,"%"),t.style.left="50%",t.style.transform="translate(-50%, -100%)"}if(this.config.tooltip.style){var o=this.config.tooltip.style;o.backgroundColor&&(t.style.backgroundColor=o.backgroundColor),o.color&&(t.style.color=o.color),o.padding&&(t.style.padding=o.padding),o.borderRadius&&(t.style.borderRadius=o.borderRadius)}else t.style.textAlign="center",t.style.backgroundColor="rgba(0, 0, 0, 0.7)",t.style.color="white",t.style.padding="8px 12px",t.style.borderRadius="4px"}}},{key:"controlVideo",value:function(t){this.log("Controlling video",t);var e=document.querySelector(this.config.videoSelector);if(e){switch(t){case"rewind":e.currentTime=Math.max(0,e.currentTime-this.config.videoControls.rewindTime);break;case"playpause":e.paused?e.play():e.pause();break;case"forward":e.currentTime=Math.min(e.duration,e.currentTime+this.config.videoControls.forwardTime);break;case"share":navigator.share?navigator.share({title:"Shared Video",text:"Check out this video!",url:window.location.href}).catch((function(t){console.error("Share failed:",t)})):alert("Share feature not supported by your browser")}this.config.callbacks.onVideoControl&&this.config.callbacks.onVideoControl(t,e.currentTime)}else this.log("Video element not found")}},{key:"deactivateOverlay",value:function(){var t=this;this.log("Deactivating overlay"),this.elements.overlay.classList.remove("active"),setTimeout((function(){t.state.active||(t.elements.overlay.style.display="none",t.elements.profileBubble.style.display="none",Object.values(t.elements.directionalEmojis).forEach((function(t){t.style.display="none"})),Object.values(t.elements.quadrantEmojis).forEach((function(t){t.style.display="none"})),t.elements.videoControls.style.display="none",t.elements.tooltip.style.display="none")}),300),this.state.active=!1,this.state.autoCancelTimer&&(clearTimeout(this.state.autoCancelTimer),this.state.autoCancelTimer=null),this.config.callbacks.onThrowDownCancel&&this.config.callbacks.onThrowDownCancel(this.state.currentQuadrant),this.log("Overlay deactivated")}},{key:"createVideoTimeSlider",value:function(){return e("div",{styles:{display:"none"}})}},{key:"openLightBox",value:function(){var t=this;this.log("Opening light-box"),this.elements.lightBox.classList.add("active"),this.state.autoCancelTimer&&(clearTimeout(this.state.autoCancelTimer),this.state.autoCancelTimer=null);var e=window.innerWidth,i=window.innerHeight;if(this.elements.lightBoxContent){var n=Math.min(.95*e,e<768?600:800),o=.85*i;this.elements.lightBoxContent.style.maxWidth=n+"px",this.elements.lightBoxContent.style.maxHeight=o+"px",e<768?(this.elements.lightBox.style.paddingTop="5vh",this.elements.lightBox.style.alignItems="flex-start"):(this.elements.lightBox.style.paddingTop="0",this.elements.lightBox.style.alignItems="center"),this.log("Responsive lightbox dimensions set",{viewport:{width:e,height:i},lightbox:{maxWidth:n,maxHeight:o}})}var a=this.config.videoPlayerApi&&this.config.videoPlayerApi.enabled&&this.config.videoPlayerApi.adapter;if(this.state.wasPlayingBefore=!!a&&a.isPlaying(),!a){var r=document.querySelector(this.config.videoSelector);this.state.wasPlayingBefore=!!r&&!r.paused}if(this.elements.videoSliderContainer||(this.elements.videoSliderContainer=this.createVideoTimeSlider(),this.elements.lightboxControlStrip&&this.elements.lightboxControlStrip.parentNode&&this.elements.lightboxControlStrip.parentNode.insertBefore(this.elements.videoSliderContainer,this.elements.lightboxControlStrip)),this.elements.lightboxControlStripObj&&this.config.videoControls.enabled){this.elements.lightboxControlStrip&&(this.elements.lightboxControlStrip.style.display="flex");var s=document.querySelector(this.config.videoSelector);if(s)try{this.elements.lightboxControlStripObj.updatePlayPauseButton?this.elements.lightboxControlStripObj.updatePlayPauseButton(!s.paused):S(this.elements.lightboxControlStrip,!s.paused)}catch(t){this.log("Error updating play/pause button",t)}}if(this.updateVideoTimeDisplay(),this.videoTimeUpdateInterval=setInterval((function(){t.updateVideoTimeDisplay()}),1e3),function(t){p.apply(this,arguments)}(this),this.elements.videoControls&&this.elements.videoControlsObj)try{this.elements.videoControlsObj.updatePlayPauseButton?this.elements.videoControlsObj.updatePlayPauseButton(!1):S(this.elements.videoControls,!1)}catch(t){this.log("Error updating play/pause button",t)}this.config.callbacks.onThrowDownInitiate&&this.config.callbacks.onThrowDownInitiate(this.state.currentQuadrant,this.state.profileBubblePosition.x,this.state.profileBubblePosition.y)}},{key:"closeLightBox",value:function(){var t=this;this.log("Closing light-box"),this.elements.lightBox.classList.remove("active"),this.videoTimeUpdateInterval&&(clearInterval(this.videoTimeUpdateInterval),this.videoTimeUpdateInterval=null),this.elements.videoControlsObj&&this.config.videoControls.enabled&&(this.elements.videoControls.parentNode&&this.elements.videoControls.parentNode.removeChild(this.elements.videoControls),this.elements.overlay&&(this.elements.overlay.appendChild(this.elements.videoControls),this.elements.videoControlsObj.setMode("overlay",this.elements.container),this.elements.videoControls.style.display="none")),this.log("Always resuming video on lightbox close"),setTimeout((function(){!function(t){h.apply(this,arguments)}(t),t.elements.videoControls&&t.elements.videoControlsObj&&(t.elements.videoControlsObj.updatePlayPauseButton?t.elements.videoControlsObj.updatePlayPauseButton(!0):S(t.elements.videoControls,!0))}),100),this.state.swipeInfo=null,this.state.swipeProcessing=!1,this.elements.lightBoxContent&&this.elements.lightBoxContent.querySelector(".swipe-info")&&this.elements.lightBoxContent.querySelector(".swipe-info").parentNode.removeChild(this.elements.lightBoxContent.querySelector(".swipe-info")),this.deactivateOverlay()}},{key:"updateVideoTimeDisplay",value:function(){if(this.elements.videoInfoDisplay){var t=document.querySelector(this.config.videoSelector);if(t){var e=function(t){if(isNaN(t)||!isFinite(t))return"0:00";var e=Math.floor(t/60),i=Math.floor(t%60);return"".concat(e,":").concat(i<10?"0":"").concat(i)},i=e(t.currentTime),n=e(t.duration);if(this.elements.videoInfoDisplay.textContent="".concat(i," / ").concat(n),this.elements.currentTimeElement&&(this.elements.currentTimeElement.textContent=i),this.elements.durationElement&&(this.elements.durationElement.textContent=n),this.elements.videoSlider&&t.duration){var o=t.currentTime/t.duration*100;this.elements.videoSlider.value=o}}}}},{key:"startRecording",value:function(){var t=this;if(this.log("Starting video recording"),this.state.recording=!0,!navigator.mediaDevices||!window.MediaRecorder)return this.log("MediaRecorder API not supported"),alert("Video recording is not supported in your browser"),void(this.state.recording=!1);navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){t.state.mediaStream=e,t.state.mediaRecorder=new MediaRecorder(e);var i=[];t.state.mediaRecorder.ondataavailable=function(t){t.data.size>0&&i.push(t.data)},t.state.mediaRecorder.onstop=function(){var e=new Blob(i,{type:"video/webm"});a("recordedVideo",URL.createObjectURL(e)),t.saveEventToHistory({type:"video_recording",size:e.size,duration:Date.now()-t.state.recordingStartTime}),t.state.mediaStream.getTracks().forEach((function(t){return t.stop()})),t.state.mediaStream=null,t.state.mediaRecorder=null,t.state.recording=!1},t.state.mediaRecorder.start(),t.state.recordingStartTime=Date.now();var n=document.createElement("div");n.className="recording-indicator",n.textContent="🔴 Recording...",n.style.position="absolute",n.style.top="10px",n.style.right="10px",n.style.backgroundColor="rgba(255, 0, 0, 0.7)",n.style.color="white",n.style.padding="5px 10px",n.style.borderRadius="4px",n.style.zIndex="1002",t.elements.lightBoxContent.appendChild(n),t.state.recordingIndicator=n})).catch((function(e){t.log("Error accessing media devices",e),alert("Could not access camera and microphone"),t.state.recording=!1}))}},{key:"stopRecording",value:function(){this.log("Stopping video recording"),this.state.mediaRecorder&&this.state.recording&&(this.state.mediaRecorder.stop(),this.state.recordingIndicator&&this.state.recordingIndicator.parentNode&&this.state.recordingIndicator.parentNode.removeChild(this.state.recordingIndicator))}},{key:"toggleVideoPause",value:function(){var t=this;this.log("Toggling video pause/play state");var e=this.config.videoPlayerApi&&this.config.videoPlayerApi.enabled&&this.config.videoPlayerApi.adapter,i=document.querySelector(this.config.videoSelector);if(e)e.isPlaying().then((function(i){if(i){e.pause();var n=t.elements.lightBox.querySelector(".td-pause-play-btn");n&&(n.textContent="▶️")}else{e.play();var o=t.elements.lightBox.querySelector(".td-pause-play-btn");o&&(o.textContent="⏸️")}}));else if(i)if(i.paused)i.play().then((function(){var e=t.elements.lightBox.querySelector(".td-pause-play-btn");e&&(e.textContent="⏸️")})).catch((function(e){t.log("Error playing video",e)}));else{i.pause();var n=this.elements.lightBox.querySelector(".td-pause-play-btn");n&&(n.textContent="▶️")}this.config.callbacks.onVideoControl&&this.config.callbacks.onVideoControl("playpause",i?i.currentTime:0)}},{key:"destroy",value:function(){this.log("Destroying QuadTap"),this.state.autoCancelTimer&&clearTimeout(this.state.autoCancelTimer),this.state.swipeDebounceTimer&&clearTimeout(this.state.swipeDebounceTimer),this.elements.container&&this.elements.container.removeEventListener("click",this.handleContainerClick),this.elements.profileBubble&&this.elements.profileBubble.removeEventListener("click",this.handleBubbleClick),this.elements.lightBox&&this.elements.lightBox.removeEventListener("click",this.handleLightBoxClick),this.elements.video&&(this.elements.video.removeEventListener("play",this.handleVideoPlay),this.elements.video.removeEventListener("pause",this.handleVideoPause)),window.removeEventListener("resize",this.throttledResize),document.removeEventListener("keydown",this.handleKeyDown),this.elements.overlay&&this.elements.overlay.parentNode&&this.elements.overlay.parentNode.removeChild(this.elements.overlay),this.elements.lightBox&&this.elements.lightBox.parentNode&&this.elements.lightBox.parentNode.removeChild(this.elements.lightBox),this.state.recording&&this.state.mediaRecorder&&this.stopRecording(),this.state.mediaStream&&this.state.mediaStream.getTracks().forEach((function(t){return t.stop()})),this.state={active:!1,profileBubblePosition:{x:0,y:0},currentQuadrant:null,autoCancelTimer:null,containerDimensions:{width:0,height:0},videoPlaying:!1,recording:!1,mediaStream:null,mediaRecorder:null,recordingStartTime:0,recordingIndicator:null,swipeDebounceTimer:null,swipeProcessing:!1},this.log("QuadTap destroyed")}}],n&&function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function P(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function O(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?P(Object(i),!0).forEach((function(e){L(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function L(t,e,i){return(e=z(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function I(t){return I="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(t){return s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":s(t)},I(t)}function z(t){var e=function(t){if("object"!=I(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=I(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==I(e)?e:e+""}var A=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings={containerId:"quad-tap-container",videoSelector:"video",debug:!1,autoCancelTimeout:3e3,autoInitialize:!1,quadrantEmojis:{topLeft:"🌈",topRight:"🔥",bottomLeft:"💧",bottomRight:"🌪️"},directionalEmojis:{north:"⬆️",east:"➡️",south:"⬇️",west:"⬅️"},thoughtEmojis:{topLeft:["🌈","🦄","🌟","🌻"],topRight:["🔥","⚡","💥","🌋"],bottomLeft:["💧","🌊","❄️","☔"],bottomRight:["🌪️","🌩️","⛈️","🌀"]},videoControls:{enabled:!0,position:"center",autoHide:!0,autoHideDelay:2e3,pauseOnLightboxOnly:!0},tooltip:{enabled:!0,position:"above-controls",text:"Tap elsewhere to cancel",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 12px",borderRadius:"4px"}},swipeNavigation:{enabled:!0,threshold:50,direction:"vertical"},northContextBar:{enabled:!0,content:"FROM"},southContextBar:{enabled:!0,content:"TO"},coordinateSystem:{type:"percentage",storeMetadata:!0},emojiSizes:{default:"24px",active:"36px"},profileBubble:{imageUrl:null,fallbackEmoji:"👤",size:"60px",borderColor:"white",borderWidth:"2px",backgroundColor:"rgba(0, 0, 0, 0.7)"},colors:{overlay:{background:"rgba(240, 240, 245, 0.5)",quadrantGradients:{topLeft:"rgba(0, 255, 255, 0.8)",topRight:"rgba(255, 255, 0, 0.8)",bottomLeft:"rgba(0, 255, 0, 0.8)",bottomRight:"rgba(255, 0, 255, 0.8)"}},lightbox:{background:"rgba(0, 0, 0, 0.9)",text:"white",headerBackground:"rgba(50, 50, 50, 0.8)",buttonPrimary:"#4CAF50",buttonSecondary:"#f44336"}},callbacks:{onOverlayActivate:null,onThrowDownInitiate:null,onThrowDownConfirm:null,onThrowDownCancel:null,onVideoControl:null},videoPlayerApi:{enabled:!1,adapter:null}}},(e=[{key:"withContainer",value:function(t){return"string"!=typeof t&&console.warn("[SettingsBuilder] containerId should be a string"),this.settings.containerId=t,this}},{key:"withVideoSelector",value:function(t){return"string"!=typeof t&&console.warn("[SettingsBuilder] videoSelector should be a string"),this.settings.videoSelector=t,this}},{key:"withDebug",value:function(t){return"boolean"!=typeof t&&console.warn("[SettingsBuilder] debug should be a boolean"),this.settings.debug=t,this}},{key:"withAutoCancelTimeout",value:function(t){return("number"!=typeof t||t<0)&&console.warn("[SettingsBuilder] autoCancelTimeout should be a positive number"),this.settings.autoCancelTimeout=t,this}},{key:"withQuadrantEmojis",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] quadrantEmojis should be an object"),this):(this.settings.quadrantEmojis=O(O({},this.settings.quadrantEmojis),t),this)}},{key:"withDirectionalEmojis",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] directionalEmojis should be an object"),this):(this.settings.directionalEmojis=O(O({},this.settings.directionalEmojis),t),this)}},{key:"withThoughtEmojisForQuadrant",value:function(t,e){return["topLeft","topRight","bottomLeft","bottomRight"].includes(t)?Array.isArray(e)?(this.settings.thoughtEmojis[t]=e,this):(console.warn("[SettingsBuilder] emojis should be an array"),this):(console.warn("[SettingsBuilder] quadrant should be one of: topLeft, topRight, bottomLeft, bottomRight"),this)}},{key:"withThoughtEmojis",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] thoughtEmojis should be an object"),this):(this.settings.thoughtEmojis=O(O({},this.settings.thoughtEmojis),t),this)}},{key:"withVideoControls",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] videoControlsConfig should be an object"),this):(this.settings.videoControls=O(O({},this.settings.videoControls),t),this)}},{key:"withTooltip",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] tooltipConfig should be an object"),this):(t.style&&"object"===I(t.style)&&(t.style=O(O({},this.settings.tooltip.style),t.style)),this.settings.tooltip=O(O({},this.settings.tooltip),t),this)}},{key:"withSwipeNavigation",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] swipeConfig should be an object"),this):(this.settings.swipeNavigation=O(O({},this.settings.swipeNavigation),t),this)}},{key:"withNorthContextBar",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] northConfig should be an object"),this):(this.settings.northContextBar=O(O({},this.settings.northContextBar),t),this)}},{key:"withSouthContextBar",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] southConfig should be an object"),this):(this.settings.southContextBar=O(O({},this.settings.southContextBar),t),this)}},{key:"withCoordinateSystem",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] coordinateConfig should be an object"),this):(this.settings.coordinateSystem=O(O({},this.settings.coordinateSystem),t),this)}},{key:"withAutoInitialize",value:function(t){return"boolean"!=typeof t&&console.warn("[SettingsBuilder] autoInitialize should be a boolean"),this.settings.autoInitialize=t,this}},{key:"withProfileBubble",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] bubbleConfig should be an object"),this):(this.settings.profileBubble=O(O({},this.settings.profileBubble),t),this)}},{key:"withOverlayColors",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] overlayColors should be an object"),this):(t.quadrantGradients&&"object"===I(t.quadrantGradients)&&(t.quadrantGradients=O(O({},this.settings.colors.overlay.quadrantGradients),t.quadrantGradients)),this.settings.colors.overlay=O(O({},this.settings.colors.overlay),t),this)}},{key:"withLightboxColors",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] lightboxColors should be an object"),this):(this.settings.colors.lightbox=O(O({},this.settings.colors.lightbox),t),this)}},{key:"withColors",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] colorConfig should be an object"),this):(t.overlay&&"object"===I(t.overlay)&&(t.overlay.quadrantGradients&&"object"===I(t.overlay.quadrantGradients)&&(t.overlay.quadrantGradients=O(O({},this.settings.colors.overlay.quadrantGradients),t.overlay.quadrantGradients)),t.overlay=O(O({},this.settings.colors.overlay),t.overlay)),t.lightbox&&"object"===I(t.lightbox)&&(t.lightbox=O(O({},this.settings.colors.lightbox),t.lightbox)),this.settings.colors=O(O({},this.settings.colors),t),this)}},{key:"withEmojiSizes",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] sizeConfig should be an object"),this):(this.settings.emojiSizes=O(O({},this.settings.emojiSizes),t),this)}},{key:"withVideoPlayerApi",value:function(t){return"object"!==I(t)?(console.warn("[SettingsBuilder] apiConfig should be an object"),this):(this.settings.videoPlayerApi=O(O({},this.settings.videoPlayerApi),t),this)}},{key:"withVideoPlayerAdapter",value:function(t){return t?(this.settings.videoPlayerApi=O(O({},this.settings.videoPlayerApi),{},{enabled:!0,adapter:t}),this):(console.warn("[SettingsBuilder] adapter should be a valid VideoPlayerAdapter instance"),this)}},{key:"onOverlayActivate",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onOverlayActivate=t,this)}},{key:"onThrowDownInitiate",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onThrowDownInitiate=t,this)}},{key:"onThrowDownConfirm",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onThrowDownConfirm=t,this)}},{key:"onThrowDownCancel",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onThrowDownCancel=t,this)}},{key:"onVideoControl",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onVideoControl=t,this)}},{key:"build",value:function(){return this.validateSettings(),JSON.parse(JSON.stringify(this.settings))}},{key:"validateSettings",value:function(){this.settings.containerId||(console.warn('[SettingsBuilder] containerId is required, using default: "quad-tap-container"'),this.settings.containerId="quad-tap-container"),this.settings.videoSelector||(console.warn('[SettingsBuilder] videoSelector is required, using default: "video"'),this.settings.videoSelector="video"),this.settings.videoControls.enabled&&!["center","bottom-center","top-center"].includes(this.settings.videoControls.position)&&(console.warn("[SettingsBuilder] Invalid video controls position: ".concat(this.settings.videoControls.position,', using default: "center"')),this.settings.videoControls.position="center"),this.settings.tooltip.enabled&&!["above-controls","below-controls","on-bubble"].includes(this.settings.tooltip.position)&&(console.warn("[SettingsBuilder] Invalid tooltip position: ".concat(this.settings.tooltip.position,', using default: "above-controls"')),this.settings.tooltip.position="above-controls"),this.settings.swipeNavigation.enabled&&!["vertical","horizontal"].includes(this.settings.swipeNavigation.direction)&&(console.warn("[SettingsBuilder] Invalid swipe direction: ".concat(this.settings.swipeNavigation.direction,', using default: "vertical"')),this.settings.swipeNavigation.direction="vertical"),["absolute","normalized","percentage"].includes(this.settings.coordinateSystem.type)||(console.warn("[SettingsBuilder] Invalid coordinate system type: ".concat(this.settings.coordinateSystem.type,', using default: "percentage"')),this.settings.coordinateSystem.type="percentage")}}])&&function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,z(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();window.quadTapInitialized=!1;var R=function(){if(window.quadTapInitialized)console.log("[QuadTap] Already initialized, skipping auto-initialization");else{var t=document.querySelectorAll("[data-quad-tap-auto-init]");if(0===t.length){var e=document.getElementById("main-video-droppable");if(e)return console.log("[QuadTap] Auto-initializing with default container"),window.quadTap=new q,e.quadTap=window.quadTap,window.quadTapInitialized=!0,window.activateOverlay=function(t,e){if(window.quadTap){var i=document.getElementById("main-video-droppable");if(i){var n=i.getBoundingClientRect(),o=t||n.width/2,a=e||n.height/2;return window.quadTap.activateOverlay(o,a)}}return!1},window.openLightBox=function(){return!!window.quadTap&&(window.quadTap.openLightBox(),!0)},window.ensureControlStripModuleAvailable=function(){!window.updatePlayPauseButton&&S&&(window.updatePlayPauseButton=S)},void window.ensureControlStripModuleAvailable()}t.length>0&&(console.log("[QuadTap] Auto-initializing ".concat(t.length," containers")),t.forEach((function(t){var e=t.id;if(e){var i=t.getAttribute("data-quad-tap-video-selector")||"video",n=t.getAttribute("data-quad-tap-profile-image"),o=(new A).withContainer(e).withVideoSelector(i).withAutoInitialize(!0);n&&o.withProfileBubble({imageUrl:n});var a=t.getAttribute("data-quad-tap-overlay-bg"),r=t.getAttribute("data-quad-tap-lightbox-bg");if(a||r){var s={};a&&(s.overlay={background:a}),r&&(s.lightbox={background:r}),o.withColors(s)}var l=new q(o.build());t.quadTap=l,window.quadTap||(window.quadTap=l)}else console.warn("[QuadTap] Container must have an ID for auto-initialization")})),window.quadTapInitialized=!0,window.activateOverlay=function(t,e){if(window.quadTap){var i=document.querySelector("[data-quad-tap-auto-init]")||document.getElementById("main-video-droppable");if(i){var n=i.getBoundingClientRect(),o=t||n.width/2,a=e||n.height/2;return window.quadTap.activateOverlay(o,a)}}return!1},window.openLightBox=function(){return!!window.quadTap&&(window.quadTap.openLightBox(),!0)},window.ensureControlStripModuleAvailable=function(){!window.updatePlayPauseButton&&S&&(window.updatePlayPauseButton=S)},window.ensureControlStripModuleAvailable())}};"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",R):R(),window.addEventListener("load",(function(){window.quadTapInitialized||(console.log("[QuadTap] Attempting initialization on window load"),R())})),setTimeout((function(){window.quadTapInitialized||(console.log("[QuadTap] Final attempt to initialize QuadTap..."),R())}),1e3),setTimeout((function(){if(!window.quadTapInitialized){console.log("[QuadTap] Forcing initialization...");var t=document.querySelectorAll("[data-quad-tap-auto-init]"),e=document.getElementById("main-video-droppable");if(t.length>0||e)console.log("[QuadTap] Found container, initializing..."),R();else{console.log("[QuadTap] No container found, creating default container...");var i=document.querySelectorAll("video");if(i.length>0){var n=i[0],o=n.parentElement,a=document.createElement("div");a.id="main-video-droppable",a.style.position="relative",o.replaceChild(a,n),a.appendChild(n),console.log("[QuadTap] Created default container, initializing..."),R()}}}}),2e3));var D=q;return D.SettingsBuilder=A,D.SettingsBuilder=A,D}()},"object"==s(e)&&"object"==s(t)?t.exports=r():(o=[],void 0===(a="function"==typeof(n=r)?n.apply(e,o):n)||(t.exports=a))}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={id:n,loaded:!1,exports:{}};return t[n](a,a.exports,i),a.loaded=!0,a.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var n={};return(()=>{"use strict";i.d(n,{default:()=>p});var t=i(642),e=i.n(t);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(t,e,i){return(e=d(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}const c=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings={containerId:"quad-tap-container",videoSelector:"video",debug:!1,autoCancelTimeout:3e3,autoInitialize:!1,quadrantEmojis:{topLeft:"🌈",topRight:"🔥",bottomLeft:"💧",bottomRight:"🌪️"},directionalEmojis:{north:"⬆️",east:"➡️",south:"⬇️",west:"⬅️"},thoughtEmojis:{topLeft:["🌈","🦄","🌟","🌻"],topRight:["🔥","⚡","💥","🌋"],bottomLeft:["💧","🌊","❄️","☔"],bottomRight:["🌪️","🌩️","⛈️","🌀"]},videoControls:{enabled:!0,position:"center",autoHide:!0,autoHideDelay:2e3,pauseOnLightboxOnly:!0},tooltip:{enabled:!0,position:"above-controls",text:"Tap elsewhere to cancel",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 12px",borderRadius:"4px"}},swipeNavigation:{enabled:!0,threshold:50,direction:"vertical"},northContextBar:{enabled:!0,content:"FROM"},southContextBar:{enabled:!0,content:"TO"},coordinateSystem:{type:"percentage",storeMetadata:!0},emojiSizes:{default:"24px",active:"36px"},profileBubble:{imageUrl:null,fallbackEmoji:"👤",size:"60px",borderColor:"white",borderWidth:"2px",backgroundColor:"rgba(0, 0, 0, 0.7)"},colors:{overlay:{background:"rgba(240, 240, 245, 0.5)",quadrantGradients:{topLeft:"rgba(0, 255, 255, 0.8)",topRight:"rgba(255, 255, 0, 0.8)",bottomLeft:"rgba(0, 255, 0, 0.8)",bottomRight:"rgba(255, 0, 255, 0.8)"}},lightbox:{background:"rgba(0, 0, 0, 0.9)",text:"white",headerBackground:"rgba(50, 50, 50, 0.8)",buttonPrimary:"#4CAF50",buttonSecondary:"#f44336"}},callbacks:{onOverlayActivate:null,onThrowDownInitiate:null,onThrowDownConfirm:null,onThrowDownCancel:null,onVideoControl:null},videoPlayerApi:{enabled:!1,adapter:null}}},(e=[{key:"withContainer",value:function(t){return"string"!=typeof t&&console.warn("[SettingsBuilder] containerId should be a string"),this.settings.containerId=t,this}},{key:"withVideoSelector",value:function(t){return"string"!=typeof t&&console.warn("[SettingsBuilder] videoSelector should be a string"),this.settings.videoSelector=t,this}},{key:"withDebug",value:function(t){return"boolean"!=typeof t&&console.warn("[SettingsBuilder] debug should be a boolean"),this.settings.debug=t,this}},{key:"withAutoCancelTimeout",value:function(t){return("number"!=typeof t||t<0)&&console.warn("[SettingsBuilder] autoCancelTimeout should be a positive number"),this.settings.autoCancelTimeout=t,this}},{key:"withQuadrantEmojis",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] quadrantEmojis should be an object"),this):(this.settings.quadrantEmojis=a(a({},this.settings.quadrantEmojis),t),this)}},{key:"withDirectionalEmojis",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] directionalEmojis should be an object"),this):(this.settings.directionalEmojis=a(a({},this.settings.directionalEmojis),t),this)}},{key:"withThoughtEmojisForQuadrant",value:function(t,e){return["topLeft","topRight","bottomLeft","bottomRight"].includes(t)?Array.isArray(e)?(this.settings.thoughtEmojis[t]=e,this):(console.warn("[SettingsBuilder] emojis should be an array"),this):(console.warn("[SettingsBuilder] quadrant should be one of: topLeft, topRight, bottomLeft, bottomRight"),this)}},{key:"withThoughtEmojis",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] thoughtEmojis should be an object"),this):(this.settings.thoughtEmojis=a(a({},this.settings.thoughtEmojis),t),this)}},{key:"withVideoControls",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] videoControlsConfig should be an object"),this):(this.settings.videoControls=a(a({},this.settings.videoControls),t),this)}},{key:"withTooltip",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] tooltipConfig should be an object"),this):(t.style&&"object"===s(t.style)&&(t.style=a(a({},this.settings.tooltip.style),t.style)),this.settings.tooltip=a(a({},this.settings.tooltip),t),this)}},{key:"withSwipeNavigation",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] swipeConfig should be an object"),this):(this.settings.swipeNavigation=a(a({},this.settings.swipeNavigation),t),this)}},{key:"withNorthContextBar",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] northConfig should be an object"),this):(this.settings.northContextBar=a(a({},this.settings.northContextBar),t),this)}},{key:"withSouthContextBar",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] southConfig should be an object"),this):(this.settings.southContextBar=a(a({},this.settings.southContextBar),t),this)}},{key:"withCoordinateSystem",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] coordinateConfig should be an object"),this):(this.settings.coordinateSystem=a(a({},this.settings.coordinateSystem),t),this)}},{key:"withAutoInitialize",value:function(t){return"boolean"!=typeof t&&console.warn("[SettingsBuilder] autoInitialize should be a boolean"),this.settings.autoInitialize=t,this}},{key:"withProfileBubble",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] bubbleConfig should be an object"),this):(this.settings.profileBubble=a(a({},this.settings.profileBubble),t),this)}},{key:"withOverlayColors",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] overlayColors should be an object"),this):(t.quadrantGradients&&"object"===s(t.quadrantGradients)&&(t.quadrantGradients=a(a({},this.settings.colors.overlay.quadrantGradients),t.quadrantGradients)),this.settings.colors.overlay=a(a({},this.settings.colors.overlay),t),this)}},{key:"withLightboxColors",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] lightboxColors should be an object"),this):(this.settings.colors.lightbox=a(a({},this.settings.colors.lightbox),t),this)}},{key:"withColors",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] colorConfig should be an object"),this):(t.overlay&&"object"===s(t.overlay)&&(t.overlay.quadrantGradients&&"object"===s(t.overlay.quadrantGradients)&&(t.overlay.quadrantGradients=a(a({},this.settings.colors.overlay.quadrantGradients),t.overlay.quadrantGradients)),t.overlay=a(a({},this.settings.colors.overlay),t.overlay)),t.lightbox&&"object"===s(t.lightbox)&&(t.lightbox=a(a({},this.settings.colors.lightbox),t.lightbox)),this.settings.colors=a(a({},this.settings.colors),t),this)}},{key:"withEmojiSizes",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] sizeConfig should be an object"),this):(this.settings.emojiSizes=a(a({},this.settings.emojiSizes),t),this)}},{key:"withVideoPlayerApi",value:function(t){return"object"!==s(t)?(console.warn("[SettingsBuilder] apiConfig should be an object"),this):(this.settings.videoPlayerApi=a(a({},this.settings.videoPlayerApi),t),this)}},{key:"withVideoPlayerAdapter",value:function(t){return t?(this.settings.videoPlayerApi=a(a({},this.settings.videoPlayerApi),{},{enabled:!0,adapter:t}),this):(console.warn("[SettingsBuilder] adapter should be a valid VideoPlayerAdapter instance"),this)}},{key:"onOverlayActivate",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onOverlayActivate=t,this)}},{key:"onThrowDownInitiate",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onThrowDownInitiate=t,this)}},{key:"onThrowDownConfirm",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onThrowDownConfirm=t,this)}},{key:"onThrowDownCancel",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onThrowDownCancel=t,this)}},{key:"onVideoControl",value:function(t){return"function"!=typeof t?(console.warn("[SettingsBuilder] callback should be a function"),this):(this.settings.callbacks.onVideoControl=t,this)}},{key:"build",value:function(){return this.validateSettings(),JSON.parse(JSON.stringify(this.settings))}},{key:"validateSettings",value:function(){this.settings.containerId||(console.warn('[SettingsBuilder] containerId is required, using default: "quad-tap-container"'),this.settings.containerId="quad-tap-container"),this.settings.videoSelector||(console.warn('[SettingsBuilder] videoSelector is required, using default: "video"'),this.settings.videoSelector="video"),this.settings.videoControls.enabled&&!["center","bottom-center","top-center"].includes(this.settings.videoControls.position)&&(console.warn("[SettingsBuilder] Invalid video controls position: ".concat(this.settings.videoControls.position,', using default: "center"')),this.settings.videoControls.position="center"),this.settings.tooltip.enabled&&!["above-controls","below-controls","on-bubble"].includes(this.settings.tooltip.position)&&(console.warn("[SettingsBuilder] Invalid tooltip position: ".concat(this.settings.tooltip.position,', using default: "above-controls"')),this.settings.tooltip.position="above-controls"),this.settings.swipeNavigation.enabled&&!["vertical","horizontal"].includes(this.settings.swipeNavigation.direction)&&(console.warn("[SettingsBuilder] Invalid swipe direction: ".concat(this.settings.swipeNavigation.direction,', using default: "vertical"')),this.settings.swipeNavigation.direction="vertical"),["absolute","normalized","percentage"].includes(this.settings.coordinateSystem.type)||(console.warn("[SettingsBuilder] Invalid coordinate system type: ".concat(this.settings.coordinateSystem.type,', using default: "percentage"')),this.settings.coordinateSystem.type="percentage")}}])&&l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function u(t,e){var i=t.querySelector("button:nth-child(2)");i&&(i.textContent=e?"❚❚":"▶")}window.quadTapInitialized=!1;var h=function(){if(window.quadTapInitialized)console.log("[QuadTap] Already initialized, skipping auto-initialization");else{var t=document.querySelectorAll("[data-quad-tap-auto-init]");if(0===t.length){var i=document.getElementById("main-video-droppable");if(i)return console.log("[QuadTap] Auto-initializing with default container"),window.quadTap=new(e()),i.quadTap=window.quadTap,window.quadTapInitialized=!0,window.activateOverlay=function(t,e){if(window.quadTap){var i=document.getElementById("main-video-droppable");if(i){var n=i.getBoundingClientRect(),o=t||n.width/2,a=e||n.height/2;return window.quadTap.activateOverlay(o,a)}}return!1},window.openLightBox=function(){return!!window.quadTap&&(window.quadTap.openLightBox(),!0)},window.ensureControlStripModuleAvailable=function(){!window.updatePlayPauseButton&&u&&(window.updatePlayPauseButton=u)},void window.ensureControlStripModuleAvailable()}t.length>0&&(console.log("[QuadTap] Auto-initializing ".concat(t.length," containers")),t.forEach((function(t){var i=t.id;if(i){var n=t.getAttribute("data-quad-tap-video-selector")||"video",o=t.getAttribute("data-quad-tap-profile-image"),a=(new c).withContainer(i).withVideoSelector(n).withAutoInitialize(!0);o&&a.withProfileBubble({imageUrl:o});var r=t.getAttribute("data-quad-tap-overlay-bg"),s=t.getAttribute("data-quad-tap-lightbox-bg");if(r||s){var l={};r&&(l.overlay={background:r}),s&&(l.lightbox={background:s}),a.withColors(l)}var d=new(e())(a.build());t.quadTap=d,window.quadTap||(window.quadTap=d)}else console.warn("[QuadTap] Container must have an ID for auto-initialization")})),window.quadTapInitialized=!0,window.activateOverlay=function(t,e){if(window.quadTap){var i=document.querySelector("[data-quad-tap-auto-init]")||document.getElementById("main-video-droppable");if(i){var n=i.getBoundingClientRect(),o=t||n.width/2,a=e||n.height/2;return window.quadTap.activateOverlay(o,a)}}return!1},window.openLightBox=function(){return!!window.quadTap&&(window.quadTap.openLightBox(),!0)},window.ensureControlStripModuleAvailable=function(){!window.updatePlayPauseButton&&u&&(window.updatePlayPauseButton=u)},window.ensureControlStripModuleAvailable())}};"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h(),window.addEventListener("load",(function(){window.quadTapInitialized||(console.log("[QuadTap] Attempting initialization on window load"),h())})),setTimeout((function(){window.quadTapInitialized||(console.log("[QuadTap] Final attempt to initialize QuadTap..."),h())}),1e3),setTimeout((function(){if(!window.quadTapInitialized){console.log("[QuadTap] Forcing initialization...");var t=document.querySelectorAll("[data-quad-tap-auto-init]"),e=document.getElementById("main-video-droppable");if(t.length>0||e)console.log("[QuadTap] Found container, initializing..."),h();else{console.log("[QuadTap] No container found, creating default container...");var i=document.querySelectorAll("video");if(i.length>0){var n=i[0],o=n.parentElement,a=document.createElement("div");a.id="main-video-droppable",a.style.position="relative",o.replaceChild(a,n),a.appendChild(n),console.log("[QuadTap] Created default container, initializing..."),h()}}}}),2e3));const p=e()})(),n.default})()));
//# sourceMappingURL=quad-tap.js.map